## Integrated AI Framework to Predict Cellular Aging / Disease Progression from TERRA Modification Patterns (Modules A–C)

### Objective (must satisfy all)
1. **Predict** cellular aging status or disease progression probability from **TERRA-related multi-omics + imaging** data.  
2. **Quantify + visualize** the functional contribution of **individual RNA modification types** (m6A, pseudouridine/Ψ, m5C) on TERRA.  
3. Provide **mechanistic interpretability** in the restricted sense of **mechanism-informed, testable hypotheses** that link predictive molecular features to **telomere/TERRA-relevant pathways** (without claiming causal proof from attributions alone).

### Feasibility-first principle (addresses data scarcity)
The framework is explicitly **tiered**, so it remains executable when only a subset of modalities is available:

- **Tier 1 (minimal viable; most feasible):** bulk RNA-seq + at least one RNA-modification assay on TERRA (often m6A; region-binned) ± standard FISH-derived quantitative metrics.  
- **Tier 2 (expanded):** add ChIP-seq telomere-associated factors and/or higher-resolution modification maps (site-level), improved imaging.  
- **Tier 3 (aspirational/rare):** add scRNA-seq and super-resolution morphology metrics.

All modules (A–C) are designed to run under **missing-modality conditions**, and model complexity is **scaled to cohort size** (regularized baselines → multimodal deep model).

### End-to-end information flow (high-level)
Raw multi-modal inputs → **Module A**: TERRA-aware QC + normalization + unified representation (confidence-weighted; supports missing modalities) → **Module B**: predictive model (complexity matched to data availability) → **Module C**: calibrated evaluation + **modification-type contribution** visualization + pathway-level hypothesis mapping + stability/FDR controls → feedback to refine Module A/B.

---

# Module A: Multimodal Data Integration and Normalization

### (1) Data types and AI tools used, with scientific justification

#### A1. Input modalities (per sample or per cell; partially missing allowed)
- **Transcriptomics**
  - Bulk RNA-seq: global aging/disease programs; expression of telomere regulators; expression of modification writers/erasers/readers (contextual covariates, not assumed causal).
  - scRNA-seq (Tier 3): cell-state composition and heterogeneity of TERRA-associated programs.
- **Epitranscriptomic / RNA modification data (TERRA-focused)**
  - m6A/Ψ/m5C assays (MeRIP-seq/miCLIP-like or analogous protocols): summarized specifically over **TERRA-defined regions**; optionally site-level when reliable.
- **Telomere-associated chromatin occupancy**
  - ChIP-seq for telomere/telomere-damage factors: summarized into interpretable locus-window signals.
- **Imaging**
  - Telomere FISH / TERRA RNA-FISH (Tier 1–2) and super-resolution metrics if available (Tier 3): telomere number, intensity, clustering, colocalization proxies.

#### A2. TERRA-specific mapping, feature construction, and QC (explicitly addresses repetitive-sequence issues)
Because TERRA/telomeric repeats cause multi-mapping and inflated false positives in modification calling, Module A treats TERRA features as **confidence-weighted** and provides explicit QC gates.

**A2a. TERRA quantification strategy (RNA-seq)**
- Use **two complementary feature channels**:
  1. **Repeat-derived TERRA signal**: quantify reads dominated by telomeric repeat content (e.g., UUAGGG-like repeats) using a repeat-aware counting strategy; treat as a **global TERRA abundance proxy** with uncertainty.
  2. **Subtelomeric/unique-anchor TERRA signal**: quantify reads mapping to subtelomeric unique regions that are plausibly linked to TERRA transcription start sites; used when uniquely mappable.
- **Multi-mapping handling:** do not force single-location assignment; instead track:
  - fraction of multi-mapped reads in TERRA-related counting,
  - sensitivity of TERRA abundance to mapping-quality thresholds.
- **QC metrics reported per sample:**
  - fraction of reads contributing to repeat-derived TERRA proxy,
  - mapping-quality distribution for TERRA-associated reads,
  - library complexity/duplication and strand bias (where applicable),
  - replicate concordance (if available) for TERRA abundance proxy.

**A2b. TERRA modification map construction (m6A/Ψ/m5C)**
- **Primary representation (robust under scarcity): region-binned modification burden**
  - Define a small number of **TERRA bins** (e.g., 10–50 bins across TERRA-like regions or assay-supported windows) per modification type.
  - For each type and bin: occupancy/enrichment statistic + assay confidence (e.g., peak score) → a **(type × bin)** matrix.
- **Optional (when data quality supports it): site-level representation**
  - Only include sites that pass reproducibility and mappability constraints (below).
- **TERRA modification QC / confidence filters (assay-agnostic principles)**
  - **Reproducibility:** require concordant signal across technical/biological replicates when available (e.g., bin-level correlation or peak overlap thresholds).
  - **Enrichment sanity checks:** IP vs input enrichment must exceed a minimum threshold; remove samples with globally poor enrichment.
  - **Mappability-aware filtering:** downweight or exclude bins/sites dominated by low mapping quality or extreme multi-mapping.
  - **Uncertainty encoding:** each bin/site carries a confidence scalar; low-confidence values can be (i) downweighted in losses, or (ii) treated as missing for that bin/type.

**A2c. Imaging preprocessing with interpretability preserved**
- Use segmentation + classical feature extraction as the **primary interpretable imaging channel**:
  - nuclei segmentation; telomere/TERRA foci detection,
  - foci count/intensity, clustering indices, colocalization proxies, nucleus morphology.
- Optional learned embeddings are permitted **only if tethered to interpretable “concepts”**:
  - train/fit a compact embedding and then **predict the above interpretable imaging metrics** from it (a “concept bottleneck” style constraint), ensuring the final fused model can attribute importance to **named morphology features**, not only opaque vectors.

#### A3. Normalization and integration model (confidence-weighted multimodal fusion)
**Core AI tool (default for Tier 2–3):** a **confidence-weighted multimodal latent model** (multimodal VAE-style fusion) with:
- shared latent \(z_{\text{shared}}\) (cross-modal aging/progression signal),
- modality-specific latents (retain modality detail),
- explicit **modification-type channels**: separate inputs/embeddings for **m6A**, **Ψ**, **m5C**.

**Training practicality safeguards (addresses optimization/modality imbalance)**
- Use modality-appropriate likelihoods/losses (e.g., count-like for RNA, continuous for imaging metrics).
- **Loss balancing:** weight each modality reconstruction loss by (i) observed-data availability and (ii) per-sample confidence (especially for modification bins).
- **KL annealing + early stopping:** to avoid posterior collapse and stabilize training; monitor per-modality reconstruction and shared-latent utilization.
- **Modality dropout** during training to support missing modalities, but applied with caps so rare modalities are not dropped excessively.

**Tier-1 alternative (when data are very limited):**
- Skip the VAE and use **standardized, confidence-weighted feature blocks** with explicit missingness indicators; integration occurs in Module B via late fusion or shallow fusion. This keeps the pipeline executable with small cohorts.

#### A4. Outputs (handoff objects to Module B)
Per sample/cell:
- unified representation: either
  - latent embeddings \(z_{\text{shared}}, z_{\text{expr}}, z_{\text{mod}}, z_{\text{chip}}, z_{\text{img}}\) (deep integration path), or
  - standardized feature blocks with missingness indicators (Tier-1 path),
- **explicit modification tensors**: \(\mathbf{M}_{\text{m6A}}, \mathbf{M}_{\Psi}, \mathbf{M}_{\text{m5C}}\) over bins/sites,
- confidence weights per bin/type and global QC flags (for downweighting/exclusion),
- metadata (batch, donor/patient, timepoint, acquisition site).

---

### (2) Alternative design choices and why they were not selected
- **Naive concatenation + PCA/UMAP:** fragile to missing modalities and batch; also obscures uncertainty in TERRA modification calls.
- **Fully site-level modeling by default:** not selected because TERRA site calls can be unreliable in repeats; region-binning is the robust default, with site-level as an opt-in when QC supports it.
- **End-to-end black-box image embeddings only:** rejected because it weakens interpretability; the framework prioritizes imaging metrics that can be named and validated.

---

### (3) How Module A outputs feed into the next stage
- Provides **confidence-weighted, modification-type–separated** representations to Module B.
- Provides missingness indicators and QC flags enabling Module B to (i) gate unreliable bins/types and (ii) avoid spurious learning from mapping artifacts.
- Provides interpretable imaging metrics (and optionally concept-tethered embeddings) so Module C can attribute risk contributions to **specific morphology features**.

---

# Module B: Predictive Model Design

### (1) Data types and AI tools used, with scientific justification

#### B1. Prediction targets
- **Aging:** binary (young vs aged), ordinal stages, and/or continuous aging score regression.
- **Disease progression:** probability within a time window and/or censoring-aware survival risk score.

#### B2. Model family is chosen by cohort size and modality availability (computational feasibility)
To avoid over-parameterization under scarce TERRA epitranscriptomic data, Module B is **adaptive**:

**B2a. Baseline (recommended starting point; Tier 1): regularized generalized linear / shallow model**
- Inputs: region-binned \(\mathbf{M}_{\text{m6A}}, \mathbf{M}_{\Psi}, \mathbf{M}_{\text{m5C}}\) + expression/pathway summaries + interpretable imaging metrics.
- Models: elastic-net logistic regression / Cox model / calibrated gradient boosting on low-dimensional blocks.
- Justification: strong performance with limited samples; clear feature effects; establishes a reproducible baseline before deep fusion.

**B2b. Full model (Tier 2–3): multimodal token model with interaction capacity**
- A **structured multimodal Transformer** (or attention-based fusion) with:
  - tokens for (i) modification-type-by-bin, (ii) expression/pathway tokens, (iii) ChIP tokens, (iv) imaging-metric tokens,
  - cross-attention to model interactions (e.g., modification pattern × telomere clustering),
  - missingness-aware attention masking.

#### B3. Explicit handling of correlated modification types (addresses “separability assumption”)
Because m6A/Ψ/m5C can be correlated (shared regulation, shared cell states), the model is constrained to avoid misleading “independent” attributions:
- **Shared trunk + type-specific heads:** a shared representation learns common epitranscriptomic signal; type-specific subheads capture residual type-specific effects.
- **Correlation-aware regularization:** penalize redundant reliance by discouraging unstable swapping of importance among types across resamples (implemented via stability constraints; evaluated in Module C).
- **Interaction terms allowed:** rather than forcing strict independence, include type×type interaction capacity so the model can represent synergy/antagonism when supported by data.

#### B4. Training objectives, calibration, and practical safeguards
- Loss: cross-entropy (classification), MSE (regression), partial likelihood / discrete-time hazards (survival).
- **Confidence-weighted learning:** modification bins/sites contribute proportionally to their calling confidence; low-confidence bins can be masked.
- **Calibration:** temperature scaling (classification) evaluated by ECE/Brier in Module C.
- **Hyperparameter selection:** nested CV with conservative search spaces; prioritize simpler models unless deep fusion yields reproducible gains under site/donor-aware splits.

#### B5. Outputs (required for Module C)
Per sample:
- predicted probability / score / risk (+ uncertainty via ensembles or dropout if used),
- intermediate representations (block-wise or token-wise),
- attention/cross-attention summaries (if transformer used),
- masks showing which modalities/bins were present and their confidence weights.

---

### (2) Alternative design choices and why they were not selected
- **Single large end-to-end multimodal deep network as default:** rejected because it is not robust to small TERRA modification cohorts; the adaptive baseline-first strategy is more reproducible.
- **Treating m6A/Ψ/m5C as strictly independent “features” without correlation modeling:** rejected due to likely biological and technical covariance; would inflate interpretability claims.

---

### (3) How Module B outputs feed into the next stage
- Delivers predictions plus explanation-ready internals (feature coefficients or token attributions/attentions).
- Provides uncertainty and confidence-weight usage logs, which Module C uses to distinguish strong signals from low-confidence artifacts.
- Enables controlled ablations (drop each modification type or imaging) to quantify incremental predictive value.

---

# Module C: Model Interpretation and Evaluation

### (1) Data types and AI tools used, with scientific justification

#### C1. Quantifying the contribution of individual RNA modification types (explicit requirement)
**Key principle:** explanations quantify **model reliance** (associative importance), not causal mechanism.

- **Local (per-sample) attribution**
  - For shallow models: coefficient × standardized feature value, with confidence intervals from bootstrap resampling.
  - For deep/token models: Integrated Gradients/DeepLIFT computed on **modification-type-by-bin tokens** (m6A vs Ψ vs m5C), respecting missingness masks and confidence weights.
- **Global attribution**
  - Aggregate absolute attributions across samples to rank: (i) modification types, (ii) TERRA bins, (iii) imaging metrics, (iv) expression/pathway tokens.
- **Correlation-aware reporting**
  - Report (a) total “epitranscriptomic” contribution and (b) conditional/type-specific contributions, emphasizing that when types are correlated, individual allocations may be non-unique.
  - Stability analysis across bootstrap folds to flag modification-type attributions that are not robust.

#### C2. Visualization deliverables (explicit requirement)
- **Per-sample stacked contribution plots:** decomposition of predicted risk into m6A vs Ψ vs m5C (and optionally other modalities), with uncertainty bands from bootstrap/ensemble variability.
- **Cohort-level distributions:** box/violin plots of type-specific attributions stratified by outcome (young/aged; progressor/non-progressor).
- **TERRA bin heatmaps:** modification type (rows) × TERRA bins (columns) showing average attribution and attribution stability.
- **Interaction summaries (when using attention/fusion):** show top cross-modal interactions (e.g., which m6A bins consistently attend to telomere clustering metrics), labeled as **model-discovered associations**.

#### C3. Mechanistic interpretability as hypothesis generation (explicitly avoids conflation with causality)
To link predictive features to biology without overclaiming:
- Compute expression-derived **pathway activity scores** (using predefined gene sets available in the study) and correlate them with:
  - top-attributed modification bins/types,
  - top-attributed telomere regulators/modification enzymes expression,
  - top-attributed chromatin and imaging metrics.
- **Mechanism mapping layer (operational definition)**
  - A curated mapping from measured features to a small set of telomere-relevant functional modules (e.g., telomere protection, replication stress response, DNA damage signaling, RNA processing/R-loop–proximal processes).
  - The output is an **enrichment-style summary**: which modules are overrepresented among stable, high-attribution features.
- **Interpretation rule:** these module links are reported as **mechanism-consistent hypotheses** requiring external biological validation; the framework itself does not claim causal proof.

#### C4. Counterfactual/perturbation analysis with in-distribution constraints (addresses validity risk)
Unconstrained perturbations can create out-of-distribution (OOD) inputs. Therefore:
- **On-manifold perturbations (preferred):**
  - If a multimodal latent model exists (Module A VAE path), perturb in latent space and decode to obtain modification patterns that remain consistent with learned data structure.
- **Empirical perturbations (Tier 1):**
  - Restrict perturbations to observed ranges (e.g., within quantiles of each bin/type) and enforce correlated co-movement when types are empirically coupled.
- **OOD checks:** discard perturbations that yield low reconstruction likelihood / violate confidence constraints, and label remaining effects as “within-model sensitivity,” not causal effect.

---

### (2) Alternative design choices and why they were not selected
- **Using attention alone as explanation:** not sufficient; attention is reported only as an interaction summary, with attribution/stability as primary evidence.
- **Single-run feature importance without uncertainty:** rejected; bootstrapping/stability is required given high dimensionality and TERRA calling uncertainty.

---

### (3) How Module C outputs feed into the next stage
- If high attribution concentrates in low-confidence/mappability-poor bins, tighten Module A filters or increase downweighting.
- If modification-type contributions are unstable across resamples, simplify Module B (stronger regularization, fewer bins) and/or emphasize total epitranscriptomic contribution rather than type-splitting.
- If performance drops under site/donor shifts, strengthen batch handling and missingness strategies in Module A/B.

---

## Evaluation protocol (metrics, splits, and reliability controls)

### Predictive performance metrics
- Classification: AUROC, AUPRC, balanced accuracy.
- Calibration: Brier score, ECE.
- Regression: R², MSE, Spearman correlation.
- Survival/progression: C-index, time-dependent AUC (as applicable).

### Validation design (leakage prevention and generalization)
- **Group-stratified splits:** keep all samples from the same donor/patient in the same fold.
- **Site-aware evaluation:** where acquisition sites differ, hold out sites to test shift robustness.
- **Temporal validation (longitudinal):** train on earlier timepoints, test on later timepoints.

### Cohort size, dimensionality control, and multiple-testing safeguards (addresses evaluation incompleteness)
- **Dimensionality control by design:** default to region-binned modification features (small bin counts) and pathway-level expression tokens to keep the effective degrees of freedom aligned with sample size.
- **Attribution stability requirement:** report only those modification-type/bin attributions that are stable across resampling (bootstrap or repeated CV).
- **Multiple comparisons control:** when highlighting “important bins/sites,” apply FDR control across bins/types (or report q-value–style thresholds) to reduce false discoveries in high-dimensional attribution maps.
- **Ablations as sanity checks:** retrain with (i) no modifications, (ii) only one modification type, (iii) no imaging, etc., to verify that claimed contributions reflect incremental predictive value.

---

## Assumptions and limitations (explicit and conservative)
- **Data availability constraint:** fully multimodal TERRA-centered datasets are often limited; hence the tiered design and baseline-first modeling are necessary for reproducibility.
- **TERRA mapping/calling uncertainty:** repetitive regions can inflate noise; the framework relies on explicit QC, mappability-aware filtering, and confidence-weighted learning rather than assuming perfect site calls.
- **Attribution ≠ causation:** feature importance and pathway/module mappings produce **testable mechanistic hypotheses** but do not establish biological mechanism without external validation.
- **Modification-type non-identifiability under correlation:** when m6A/Ψ/m5C are strongly correlated, unique decomposition of risk into separate types may be unstable; the framework therefore reports stability and, when needed, emphasizes combined epitranscriptomic contribution.

This revised three-module design remains aligned with the problem requirements while explicitly addressing feasibility, TERRA-specific technical artifacts, correlation-aware interpretation of modification types, and conservative “mechanism-informed hypothesis” reporting.