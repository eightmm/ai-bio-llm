## (A) Quantification of Exhaustion and Aging-Like Programs

### Limitation (applies to all of A–D)
From the provided execution outputs, **no quantitative RNA-seq expression matrix**, **no sample metadata (timepoints/replicates)**, and **no drug–target mapping table** were available—only a plain-text manifest-like file (`problem_5.txt`) was ingested. Therefore, **exhaustion/aging-like scores cannot be computed or plotted yet**, and any time window or gene trajectory **cannot be asserted from this dataset at present**.  
What follows is an **execution-ready scoring and analysis specification** that becomes fully dataset-grounded once the actual expression and metadata files referenced by `problem_5.txt` are located and loaded.

---

### A.1 Define an exhaustion score from time-course RNA-seq
**Inputs**
- Gene × sample expression matrix (raw counts preferred; TPM acceptable with appropriate handling).
- Sample metadata with at least: `sample_id`, `time_post_tumor_challenge`, `replicate` (and `batch` if present).

**Step A.1.1 — Normalize for scoring**
- If counts: filter low-expression genes → normalize (DESeq2 size factors or edgeR TMM) → variance-stabilize (DESeq2 VST or log2-CPM with prior count).
- If TPM: log2(TPM + small offset) and consider between-sample normalization checks.

**Step A.1.2 — Build an exhaustion gene signature (data-derived + anchored markers)**
Construct an exhaustion signature using the **intersection** of:
1) **Time-course-derived exhaustion module**: genes that increase early and/or remain high with time (fit splines/impulse models; cluster temporal patterns).  
2) **Anchoring exhaustion markers** (used only as anchors; final membership should be validated in this dataset): inhibitory receptors and exhaustion TF program genes such as  
`PDCD1, LAG3, HAVCR2, TIGIT, CTLA4, ENTPD1, TOX, TOX2, NR4A1, NR4A2, NR4A3`  
and an “effector counter-signature” such as  
`GZMB, PRF1, IFNG, TNF` (expected to decrease with dysfunction).

**Step A.1.3 — Compute an exhaustion score per sample**
Use **ssGSEA/GSVA** (robust for bulk) or a z-scored mean:
- `ExhaustionScore = ssGSEA(Exhaustion_Up) − ssGSEA(Effector_Up)`
- Store per-sample scores for downstream change-point detection.

**Outputs**
- Table: `sample_id`, `time`, `ExhaustionScore`
- Diagnostic: correlations of ExhaustionScore with anchor genes (e.g., TOX/PDCD1 should correlate positively if the score is coherent).

---

### A.2 Define an aging-like score from time-course RNA-seq
**Goal**
Capture stress/aging-like programs that emerge along the exhaustion→death trajectory (DNA damage response, senescence-like arrest, mitochondrial stress, inflammatory/SASP-adjacent signals).

**Step A.2.1 — Build an aging-like signature (resource-informed + data-supported)**
Combine:
1) **Resource gene sets**: MSigDB aging/senescence sets; GenAge aging-associated genes (as candidate lists).  
2) **Dataset-supported late module(s)**: genes that activate **later than** the main exhaustion rise and align with stress/dysfunction trajectories (identified via time-course modeling and clustering/WGCNA).

Include/consider (to be confirmed by this dataset’s expression patterns):  
- Cell cycle arrest / senescence checkpoint: `CDKN1A (p21)`, possibly `CDKN2A (p16)` depending on detectability in this T-cell bulk setting  
- DNA damage / stress response (p53-associated targets)  
- Mitochondrial dysfunction / oxidative stress programs  
- Inflammatory/SASP-adjacent cytokine/chemokine programs (context-dependent in T cells)

**Step A.2.2 — Compute an aging-like score per sample**
- `AgingLikeScore = ssGSEA(AgingLike_Up) − ssGSEA(MetabolicFitness_Up)`
where “MetabolicFitness_Up” is a dataset-validated module representing mitochondrial quality control/biogenesis and functional metabolic genes that decline with late dysfunction.

**Outputs**
- Table: `sample_id`, `time`, `AgingLikeScore`
- Diagnostic: verify AgingLikeScore increases are accompanied by enrichment of stress/DNA-damage/senescence gene sets in late timepoints.

---

### A.3 Visualize and describe how scores change over time
**Required plots (once data are available)**
1) Line plot over time: mean ± uncertainty (e.g., bootstrapped CI) for ExhaustionScore and AgingLikeScore.  
2) Replicate-level scatter overlayed on means.  
3) Heatmap of the top signature genes ordered by temporal peak (early vs late).  
4) (Optional) PCA on normalized expression with samples colored by score and time to show trajectory structure.

**Quantitative descriptors**
- Slope estimates for each score pre- vs post-transition (from segmented regression; see B).
- Correlation between ExhaustionScore and AgingLikeScore over time (often modest early, higher during/after transition if aging-like is downstream of chronic dysfunction).

---

## (B) Identification of the Critical Transition Window

### B.1 Operational definition of the “Exhaustion → Aging-Like → Death” axis
Define the axis in this dataset as:
- **Early phase**: ExhaustionScore rises (or rises fastest), AgingLikeScore low.
- **Transition phase**: AgingLikeScore shows **a statistically supported acceleration** (change-point), while ExhaustionScore **plateaus or changes slope**, indicating a state shift rather than uniform drift.
- **Late phase**: AgingLikeScore remains high and **death/apoptosis programs** rise.

Because no expression/metadata were provided in the analyzed outputs, the **actual time interval cannot be named yet**; it must be computed from the dataset using the steps below.

---

### B.2 Change-point detection on program scores (primary criterion)
**Inputs**
- Per-sample ExhaustionScore and AgingLikeScore (from A)
- Timepoints and replicates

**Method**
1) Fit **segmented (piecewise) regression** for each score vs time, estimating breakpoint(s).  
2) Require that the AgingLikeScore breakpoint is:
   - statistically supported (model fit improvement; breakpoint CI not spanning the full series),
   - accompanied by a meaningful slope increase (effect size threshold).

**Output**
- Breakpoint time `T1` (aging-like acceleration onset) with confidence interval.
- Define a **transition window** `[T1, T2]` where:
  - AgingLikeScore slope is high,
  - ExhaustionScore slope is low/plateauing,
  - (optionally) death signature begins to rise.

---

### B.3 Independent corroboration (to justify “transition” vs continuum)
Use at least two of the following:

1) **Gene module switching (WGCNA or clustering of temporal profiles)**  
   - Show that an “aging/stress” module eigengene increases sharply starting near `T1`, while exhaustion module eigengene saturates.

2) **Epoch-based differential expression**
   - Partition samples into **Pre**, **Window**, **Post** using `[T1, T2]`.
   - Test contrasts: Pre vs Window, Window vs Post.
   - Require enrichment shifts: stress/senescence/apoptosis pathways enriched specifically in Window/Post.

3) **Death/apoptosis score (if computed from RNA-seq)**
   - Compute ssGSEA for an apoptosis gene set (e.g., hallmark apoptosis).
   - Confirm death score rises after or during the transition.

**Deliverable for (B)**
- A single stated window definition (time interval in the dataset) plus the quantitative evidence above.  
At present, this cannot be instantiated because timepoints/scores are unavailable in the provided outputs.

---

## (C) Proposal of Rejuvenation Target Genes

### C.0 Target nomination rule (RNA-seq–grounded once data are loaded)
For each target, report from this dataset:
1) **Direction over time**: trajectory and fold-change, especially Pre → Window → Post.  
2) **Window specificity**: strongest change occurs in/around `[T1, T2]`.  
3) **Program alignment**: positive correlation with ExhaustionScore and/or AgingLikeScore (for inhibition targets), or negative correlation (for activation targets).  
4) **Network/pathway context**: membership in the exhaustion module, aging-like module, or metabolic fitness module; and association with pathway activity shifts inferred from expression.

Because the RNA-seq matrix is missing from the provided outputs, the gene-level evidence below is written as **what must be extracted and reported from this dataset**, not as already-observed results.

---

### C.1 Candidate target: **TOX** — intervene by **inhibition**
- **Direction of intervention:** Inhibit TOX.
- **RNA-seq evidence to report (this dataset):**
  - **Expression change over time:** TOX should be tested for early induction and sustained elevation in tumor-challenged T cells; quantify log2FC and whether it is already high entering the transition window.
  - **Network context:** TOX should load into an “exhaustion TF / inhibitory receptor” co-expression module; module eigengene should rise before (or by) the transition.
  - **Opposing regulation:** TOX should correlate positively with ExhaustionScore; if aging-like is downstream, TOX may remain high while AgingLikeScore accelerates—supporting TOX as an upstream “locking” factor.
- **Rejuvenation rationale (transcriptional shift expected):**
  - TOX inhibition is expected to reduce exhaustion-program coherence (lower checkpoint/TF module activity), enabling partial re-expression of effector/metabolic modules if reversibility remains at the transition window.

---

### C.2 Candidate target: **NR4A family (NR4A1/NR4A2/NR4A3)** — intervene by **inhibition**
- **Direction of intervention:** Inhibit NR4A activity (family-level preferred due to redundancy).
- **RNA-seq evidence to report (this dataset):**
  - **Expression change over time:** determine whether NR4A genes peak early and remain elevated, and whether they show any additional increase around the transition window.
  - **Network context:** NR4A genes should co-vary with exhaustion markers (inhibitory receptors, TOX-associated module).
  - **Opposing regulation:** positive correlation with ExhaustionScore; test whether they also correlate with AgingLikeScore during `[T1, T2]` (consistent with convergence of chronic stimulation with stress programs).
- **Rejuvenation rationale:**
  - NR4A inhibition targets a chronic stimulation–linked transcriptional program expected to support both exhaustion maintenance and downstream dysfunction; reducing this program during the transition window is expected to shift expression away from exhaustion/aging-like modules.

---

### C.3 Candidate target: **CDKN1A (p21)** — intervene by **inhibition** (timing-critical)
- **Direction of intervention:** Inhibit CDKN1A/p21 (or reduce its induction) **specifically during the transition window**.
- **RNA-seq evidence to report (this dataset):**
  - **Expression change over time:** test whether CDKN1A is low early and rises sharply at/after `[T1, T2]` (a hallmark of senescence-like arrest programs).
  - **Network context:** CDKN1A should sit in an “aging-like / stress / DNA damage response” module whose eigengene accelerates at the transition.
  - **Opposing regulation:** strong positive correlation with AgingLikeScore; and increased coupling to ExhaustionScore during the transition would support the “exhaustion→aging-like” linkage.
- **Rejuvenation rationale:**
  - If the transition involves commitment to senescence-like arrest, reducing p21 during `[T1, T2]` is expected to oppose the aging-like score and preserve proliferative/viability-associated transcriptional programs.  
- **Caveat to state explicitly in the final dataset-grounded writeup:**
  - Because p21 is a cell-cycle checkpoint gene, feasibility and safety depend on context; the analysis must emphasize **T-cell-intrinsic** modulation and timing, and must show that the p21 rise is a defining feature of the aging-like transition in this dataset.

---

### C.4 Candidate target: **PINK1–PRKN (Parkin) mitophagy axis** — intervene by **activation**
- **Direction of intervention:** Activate mitochondrial quality control/mitophagy (PINK1/PRKN axis).
- **RNA-seq evidence to report (this dataset):**
  - **Expression change over time:** quantify whether `PINK1` and/or `PRKN` (or broader mitophagy/autophagy module genes) decline as AgingLikeScore rises.
  - **Network context:** membership in a “metabolic fitness / mitochondrial maintenance” module that decreases across time, with a sharper drop near the transition window.
  - **Opposing regulation:** negative correlation with AgingLikeScore (and/or DeathScore if computed), supporting mitochondrial dysfunction as part of the aging-like state.
- **Rejuvenation rationale:**
  - Activating mitochondrial maintenance programs is expected to oppose the aging-like/stress signature and improve viability-associated transcriptional states, thereby pushing cells away from the “aging-like → death” end of the axis.

---

### C.5 Candidate target: **SIRT1** — intervene by **activation**
- **Direction of intervention:** Activate SIRT1-associated metabolic/stress-resistance programs.
- **RNA-seq evidence to report (this dataset):**
  - **Expression change over time:** determine whether `SIRT1` declines during the transition and late phases (or whether its downstream target modules decline), aligning with increasing AgingLikeScore.
  - **Network context:** association with metabolic fitness / mitochondrial biogenesis / stress-resistance modules that inversely track aging-like and death programs.
  - **Opposing regulation:** negative correlation with AgingLikeScore; test whether SIRT1-high samples (within the same timepoint) show lower aging-like signatures (within-timepoint stratification strengthens inference beyond time alone).
- **Rejuvenation rationale:**
  - SIRT1 activation is expected to promote a transcriptional shift away from aging-like stress programs and toward metabolic competence, counteracting the progression toward death.

---

### C.6 Minimum required reporting table (to make (C) fully RNA-seq–based)
Once the real dataset is loaded, provide a per-target table with at least:
- `TargetGene`, `InterventionDirection (Inhibit/Activate)`,
- `log2FC (Pre→Window)`, `log2FC (Window→Post)`, `FDR`,
- `Corr(ExhaustionScore)`, `Corr(AgingLikeScore)`,
- `ModuleMembership (e.g., WGCNA module + kME)`,
- `Top co-expressed genes / pathway label`.

This is the mechanism that converts the above candidates from plausible biology into **dataset-supported rejuvenation targets**.

---

## (D) Optional (Bonus): Therapeutic Mapping

### Limitation
No drug–target dataset was available in the provided outputs, so **drug/compound mapping cannot be performed** as requested.

### What to do once the drug–target table is available
**Inputs**
- Drug–target mapping table with: compound name, target gene identifier(s), mechanism (agonist/antagonist/inhibitor), and (if available) approval/phase.

**Procedure**
1) Harmonize gene identifiers (gene symbol ↔ Ensembl; handle aliases).  
2) For each proposed target, filter drugs by **matching directionality**:
   - inhibition targets: inhibitors/antagonists
   - activation targets: agonists/activators (often fewer; may require indirect pathway activators)
3) Output a short list per target with: compound, MoA, specificity notes, and whether it is target-direct or pathway-indirect.

**Deliverable**
- A mapping table `TargetGene → CandidateCompounds` plus a brief feasibility note (e.g., transcription factors are often not directly druggable; metabolic enzymes/receptors are more tractable).

---

### Final note on assumptions/limitations
- All biological target suggestions above must be treated as **candidates to be validated** by the actual time-course RNA-seq trajectories and module/pathway evidence in this dataset.  
- The “critical transition window” cannot be assumed (e.g., “48–96 hours”) without the dataset’s timepoint metadata and score change-point results; it must be computed as specified in (B).