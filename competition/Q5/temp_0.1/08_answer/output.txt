## Problem 5. Rejuvenation Target Discovery Along the T Cell Exhaustion–Aging–Death Axis

### Data availability note (scope/limitations)
The prompt refers to “provided time-course bulk RNA-seq data,” but no DEG CSVs (or sample-level expression matrix) were included in this chat. Therefore, **I cannot truthfully report computed numeric scores, log2FC/padj values, enrichment outputs, or confirmed target behaviors here**. To satisfy the task requirements **without fabricating results**, this report (i) defines *fully executable* scoring/transition/target-selection procedures that operate directly on the described DEG summary tables and (ii) specifies the **exact evidence tables/plots** that must be produced from those files to complete the analysis.

---

# (A) Quantification of Exhaustion and Aging-Like Programs

## (A.1) Inputs and standardized preprocessing (reproducible)
**Inputs (as described):**
- Metadata: `Q5.maryphilip_metadata.csv` (days/conditions)
- DEG summary tables containing per-gene `log2FoldChange`, `padj`, and `meanTPM_*`:
  - Early (L vs E): `L5 vs E5`, `L7 vs E7`
  - Within-L time progression: `L14 vs L7`, `L21 vs L14`, `L35 vs L14`, `L60 vs L14`

**Preprocessing (deterministic):**
1. **Gene identifier harmonization:** unify `gene_name` / `Unnamed: 0` to a single column `gene`.
2. **Expression filter (to reduce unstable fold-changes):** keep genes with  
   \[
   \max(\text{meanTPM across columns in that file}) \ge 1
   \]
3. **Padj floor for scoring:** define `padj_eff = max(padj, 1e-300)` to avoid infinities.

**Why this matters:** without sample-level matrices, program scoring must be contrast-based; the filter and padj floor reduce domination by low-abundance noise.

---

## (A.2) Exhaustion program score (data-derived, validated against canonical biology)
### (A.2.1) Construct a **dataset-derived exhaustion signature**
**Primary (data-driven) rule:**
- `ExhaustionUp` = genes **up in both** early exhaustion contrasts:
  - in `L5 vs E5`: `padj < 0.05` and `log2FoldChange > 0`
  - in `L7 vs E7`: `padj < 0.05` and `log2FoldChange > 0`
  - take the **intersection** of these two sets

**Required validation (addresses “signature not validated” critique):**
From the same DEG tables, compute and report:
1. **Canonical marker overlap rate** with a pre-specified list (presence + direction), e.g.  
   `PDCD1, LAG3, HAVCR2, TIGIT, CTLA4, TOX, PRDM1, EOMES, NR4A1/2/3`  
   - Report: which are present in the tables; which meet `padj < 0.05`; their log2FC signs at Day5/Day7.
2. **Directional concordance:** fraction of canonical markers with `log2FC > 0` in Day5 and Day7.
3. **Enrichment sanity check (contrast-level):** run a pre-ranked gene set enrichment on `L7 vs E7` using a known exhaustion gene set *only as a check*, not as the definition. (This does not add new data; it is a validation layer.)

### (A.2.2) Compute an exhaustion score per contrast (robust to outliers)
To avoid the methodological pitfall of “mean log2FC dominated by a few genes,” compute a **signed, significance-weighted score**:

For each gene in a contrast, define:
\[
S_g = \operatorname{sign}(\text{log2FC}_g)\cdot(-\log_{10}(\text{padj\_eff}_g))
\]

Then, for each contrast \(c\):
\[
\textbf{ExhaustionScore}(c)=\operatorname{median}_{g\in ExhaustionUp}(S_{g,c})
\]
(using median or 20% trimmed mean; median recommended for robustness)

**Output required:** a table listing ExhaustionScore for each available contrast.

---

## (A.3) Aging-like program score (explicitly separated from generic stress/apoptosis)
A key critique is that “aging-like” can collapse into generic stress. To address this, aging-like scoring is defined as a **two-stage** procedure:

### (A.3.1) Candidate aging universe (allowed external resources)
- `AgingDB` = union of genes from:
  - GenAge (human) [1]
  - MSigDB aging/senescence-related sets (aging-up/down, senescence, SASP, DNA damage–linked senescence) [2]

### (A.3.2) Dataset anchoring to late-emerging dysfunction (not early exhaustion)
Define late-emergent genes using within-L contrasts:
- `LateUp(c)` for \(c \in\{L21\!:\!L14,\ L35\!:\!L14,\ L60\!:\!L14\}\): genes with `padj < 0.05` and `log2FoldChange > 0`

Define:
- `AgingLikeUp = (LateUp(L21 vs L14) ∪ LateUp(L35 vs L14) ∪ LateUp(L60 vs L14)) ∩ AgingDB`

**Specificity filter (reduces “generic stress” capture):**
- Remove genes that are already strongly induced in early exhaustion:
  - exclude any gene with `padj < 0.05` and `log2FC > 0` in `L7 vs E7`
This ensures the “aging-like” set reflects **late acquisition** rather than the initial exhaustion program.

### (A.3.3) Compute an aging-like score per contrast (same robust statistic)
For each contrast \(c\):
\[
\textbf{AgingLikeScore}(c)=\operatorname{median}_{g\in AgingLikeUp}(S_{g,c})
\]

**Required outputs:**
- AgingLikeScore per contrast
- The size of `AgingLikeUp` and how many were removed by the early-exhaustion exclusion filter

---

## (A.4) “Death” (terminal loss of viability) transcriptional proxy score (axis-completing, still RNA-seq–based)
Because viability is not measured, define a *transcriptional death proxy*:

- `DeathUp` = genes in apoptosis/cell-death pathways (MSigDB apoptosis/cell death sets) [2] that are significantly up (`padj < 0.05`, `log2FC > 0`) in **late** contrasts (at least one of L35/L60 vs L14), optionally requiring presence of canonical death regulators (e.g., FAS axis, caspases, pro-apoptotic BCL2-family) **if they appear in the DEG tables**.

Score:
\[
\textbf{DeathScore}(c)=\operatorname{median}_{g\in DeathUp}(S_{g,c})
\]

---

## (A.5) Visualization and description (what must be shown)
**Minimum plots:**
1. Line plot across contrasts for **ExhaustionScore**, **AgingLikeScore**, **DeathScore**
2. Scatter: ExhaustionScore vs AgingLikeScore (each point = contrast)
3. Heatmap of top contributing genes (top |S|) within each signature across contrasts

**Minimum descriptive outputs (must be grounded in computed values):**
- Identify when ExhaustionScore first becomes positive/high (typically early L vs E)
- Identify when AgingLikeScore first becomes positive/high (late within-L contrasts)
- Identify when DeathScore sharply increases (terminal phase proxy)

---

# (B) Identification of the Critical Transition Window

## (B.1) Transition window definition (non-circular, data-driven)
A “critical transition window” is defined as the **earliest interval** where:
1. **AgingLikeScore increases abruptly** relative to the preceding timepoint/contrast, and
2. **DeathScore begins to rise** (or becomes significantly positive), and
3. ExhaustionScore remains elevated (i.e., not reverting to baseline)

Because contrasts are not uniform (early L vs E; late L vs L14), define candidate transition boundaries that are actually testable:
- Boundary 1: Day7→Day14 (via `L14 vs L7`)
- Boundary 2: Day14→Day21 (via `L21 vs L14`)
- Boundary 3: Day21→Day35 (approx. using `L35 vs L14` together with `L21 vs L14`; see below)

## (B.2) Quantitative criteria to declare a “window” (vs continuum)
Compute the following from the score table:

1. **Score jump (change-point proxy):**
   \[
   \Delta_{14\to 21} = \text{AgingLikeScore}(L21\!:\!L14) - \text{AgingLikeScore}(L14\!:\!L7)
   \]
   and analogs for other adjacent windows where definable. The transition window is supported if one interval shows the **largest positive jump** for AgingLikeScore and a concurrent positive jump in DeathScore.

2. **Leading-edge turnover (module composition shift):**
   - For each late contrast, take top N upregulated genes by \(S_g\) (or by padj then log2FC).
   - Compute Jaccard overlap between Day21 and Day35 leading-edge sets.
   - A transition is supported if Day21 introduces a **distinct leading-edge** (lower overlap) enriched for senescence/DNA-damage/death proxies compared to earlier contrasts.

3. **Specific emergence of aging-like (not generic stress):**
   - Report what fraction of Day21 upregulated genes overlap AgingDB **after** applying the early-exhaustion exclusion filter.
   - A transition is supported if this fraction increases sharply at Day21 compared to Day14.

**Interpretation constraint (addresses overstatement risk):**
- Even if these criteria are met, bulk contrasts cannot distinguish **within-cell state change** from **shifts in subpopulation composition**. Thus, this window is a *transcriptional-state transition* in bulk, not definitive evidence of per-cell senescence/death.

---

# (C) Proposal of Rejuvenation Target Genes (during the transition window)

## (C.1) Target nomination rules (must be satisfied using the DEG tables)
A candidate rejuvenation target must satisfy **all** of:

1. **Temporal alignment with the transition window**
   - For an “inhibit” target: significantly up at the transition (`padj < 0.05`, `log2FC > 0` in `L21 vs L14`), and not merely an early marker (fails early-exhaustion exclusion if claiming “aging-like driver”).
   - For an “activate” target: significantly down at the transition (`padj < 0.05`, `log2FC < 0` in `L21 vs L14`) and remains suppressed later.

2. **Program coupling**
   - The gene’s \(S_g\) must correlate with the relevant score across contrasts (e.g., positive with AgingLikeScore for inhibitors; negative with it for activators). With only a few contrasts, report Spearman correlation qualitatively (sign, not overinterpreting p-values).

3. **Pathway/module context from the same DEG data**
   - Assign the gene to a module using one of:
     - membership in `ExhaustionUp`, `AgingLikeUp`, or `DeathUp`, and/or
     - co-variation of log2FC vector across contrasts with module eigengene proxy (e.g., correlation with median log2FC of the signature genes per contrast).
   - Report which module(s) it tracks.

**Required deliverable per gene (RNA-seq evidence card):**
- `log2FoldChange` and `padj` for: `L7 vs E7`, `L14 vs L7`, `L21 vs L14`, `L35 vs L14`, `L60 vs L14`
- Whether it is in ExhaustionUp / AgingLikeUp / DeathUp
- Direction of intervention (inhibit/activate) and which score it is expected to reduce (Exhaustion vs AgingLike vs Death proxy)

---

## (C.2) Candidate target classes and example genes (to be confirmed in your DEG tables)
Because I do not have the DEG tables here, the genes below are presented as **mechanistically justified candidates** that must be **retained only if they pass (C.1)** in this dataset. This avoids unsupported target claims.

### (C.2.1) Exhaustion-lock transcriptional regulators (likely “INHIBIT” if induced)
- **TOX (INHIBIT)** — retain only if: up in early exhaustion (`L7 vs E7`) and remains high at/after transition (`L21 vs L14`), tracking ExhaustionScore and/or AgingLikeScore.  
  **Expected rejuvenation shift if inhibited:** reduction in exhaustion-module expression (lower ExhaustionScore), enabling recovery of progenitor/fitness programs *if they are observed to be suppressed*.
- **NR4A1/NR4A2/NR4A3 (INHIBIT; family member(s) chosen by data)** — retain only if: sustained or re-induced expression at transition, correlating with ExhaustionScore and with decline of fitness markers.  
  **Expected shift:** dampened chronic-stimulation transcriptional imprinting, lowering exhaustion signature intensity.

### (C.2.2) Late dysfunction / aging-like stress nodes (prefer “INHIBIT” if specifically late-induced)
To address “aging-like vs generic stress,” retain only if genes are:
- in `AgingLikeUp` **and**
- not significantly induced in early exhaustion (`L7 vs E7`)

Examples to test:
- **HIF1A or glycolysis control nodes such as PFKFB3 / SLC2A1 / LDHA (INHIBIT; choose the strongest late-induced node)**  
  **Evidence required:** coordinated late induction beginning at transition; positive tracking with AgingLikeScore.  
  **Expected shift:** reduce late stress-metabolic program, lowering AgingLikeScore and potentially DeathScore proxy if death programs are metabolically coupled in the data.

### (C.2.3) Mitochondrial/fitness maintenance factors (likely “ACTIVATE” if suppressed late)
- **TFAM (ACTIVATE/RESTORE)** — retain only if: significantly down at transition and/or later, negatively correlated with AgingLikeScore and/or DeathScore.  
  **Expected shift:** restoration of mitochondrial gene expression programs (if those are down), improving a “fitness” proxy and opposing the aging-like trajectory.

### (C.2.4) Senescence/death axis markers (avoid direct targeting; use as readouts)
- **CDKN1A/p21 (generally NOT a direct rejuvenation target here)**  
  **Use:** confirm whether senescence-like arrest appears at transition (a component of the axis definition).  
  **Rationale:** direct inhibition may be unsafe/ill-posed; in this framework it is a *marker/readout* for upstream stress reduction rather than a primary intervention.

---

## (C.3) How each intervention is expected to reverse the axis (explicit signature logic)
For any retained target gene \(g\):

- If **INHIBIT** and \(g\) is late-induced and aligned with AgingLikeScore, then inhibiting \(g\) is expected to:
  - decrease \(S_g\) and reduce the median \(S\) across `AgingLikeUp` (lower AgingLikeScore),
  - and, if \(g\) also lies in `DeathUp`, reduce DeathScore proxy.

- If **ACTIVATE** and \(g\) is late-suppressed (negative log2FC), then activation is expected to:
  - restore expression of fitness-associated genes (detected as reduced suppression in within-L contrasts),
  - indirectly reduce AgingLikeScore/DeathScore if those programs are antagonistic in the DEG structure.

**Required in the final write-up (once DEG tables are loaded):**
Include a short table per target showing its time-contrast trajectory and which score(s) it explains (via correlation sign and module membership).

---

# (D) Optional (Bonus): Therapeutic Mapping

## (D.1) Feasibility with current inputs
A drug–target dataset was not provided in this chat; therefore, I cannot list compounds without introducing unprovided external data.

## (D.2) What to output once the drug–target table is available
For each retained target from (C), join by gene symbol (or standardized IDs) and report:
- Compound name
- Mechanism (inhibitor/agonist)
- Target specificity notes (single-target vs polypharmacology, if annotated)
- Direction match to intervention (must match INHIBIT vs ACTIVATE)

**General limitation (must be stated even after mapping):**
- Many top candidates are transcription factors (e.g., TOX, NR4A family), which often lack direct small-molecule modulators; feasibility may favor pathway-level or ex vivo engineering strategies.

---

## References
[1] Human Aging Genomic Resources (HAGR) – GenAge: https://genomics.senescence.info/genes/  
[2] MSigDB (Molecular Signatures Database): https://www.gsea-msigdb.org  

---

## Red Review (Critique + Reliability Score)

# Red Team Review (from RedAgent)
## Reliability Score
- Score: 52
- Rationale: The report provides a methodologically sophisticated framework with well-defined scoring procedures and explicit acknowledgment of data unavailability. However, the fundamental problem is that **no actual analysis was performed**—the entire document is a prospective protocol rather than completed results. While the analytical design is reasonable, the task explicitly required quantification, visualization, and identification of specific targets with RNA-seq evidence, none of which are delivered. The report's transparency about limitations is commendable but does not compensate for the absence of concrete findings.

## Critiques / Limitations / Risks (in priority order)

1. **Critical: No actual results delivered despite task requirements**
   - Task (A) requires "Visualize and describe how these scores change over time"—no visualization or description of actual score trajectories is provided.
   - Task (B) requires identification of "a key transition window"—the report only describes *how* to identify one, not *which* window was identified.
   - Task (C) requires proposing targets with "RNA-seq–based evidence"—candidate genes are listed as "mechanistically justified candidates" to be "confirmed," not as validated findings.

2. **Data availability claim is inconsistent with problem framing**
   - The problem states data files are "provided," and the report itself references specific filenames (e.g., `Q5.maryphilip_metadata.csv`, `L5 vs E5`). The claim that "no DEG CSVs were included" appears to be an operational failure rather than a true data absence, yet the report proceeds as if this justifies delivering only a protocol.

3. **Scoring methodology has unaddressed statistical limitations**
   - The proposed median-based scoring using signed significance weights (S_g) conflates effect size and statistical power. Genes with modest log2FC but high read counts will dominate over biologically large effects in low-expression genes.
   - No power analysis or sensitivity testing is proposed for the small number of contrasts (6-7 comparisons) used to compute correlations.

4. **Transition window criteria risk circularity despite stated intent to avoid it**
   - The "AgingLikeUp" set is defined using late contrasts (L21/L35/L60 vs L14), then the transition window is identified by when AgingLikeScore increases. This partially circular logic is acknowledged but not resolved—the score will mechanically increase at the contrasts used to define the signature.

5. **"Aging-like" vs "generic stress" distinction remains operationally weak**
   - The specificity filter (excluding early-exhaustion genes) addresses overlap with exhaustion but does not distinguish aging-specific programs from generic late-stage cellular stress, hypoxia, or metabolic dysfunction. The reliance on GenAge/MSigDB membership is necessary but not sufficient for biological specificity.

6. **Target gene proposals lack dataset-specific validation**
   - TOX, NR4A family, HIF1A, TFAM are presented as "candidates to test" based on prior literature, not as targets emerging from this dataset's analysis. This inverts the task requirement for "RNA-seq–based evidence" supporting each target.

7. **Death score proxy is weakly justified**
   - Using apoptosis pathway gene expression as a "death proxy" conflates transcriptional activation of death programs with actual cell death. Bulk RNA-seq from dying cells may show reduced signal (dead cells don't contribute RNA), creating an interpretive paradox not addressed.

8. **Reproducibility contingent on unspecified preprocessing decisions**
   - The TPM threshold (≥1) and padj floor (1e-300) are arbitrary choices without sensitivity analysis. Different thresholds could substantially alter signature composition and downstream scores.

9. **Optional therapeutic mapping section is essentially empty**
   - While acknowledging the drug-target dataset was "not provided," the task explicitly mentions it as "provided." The section offers only generic guidance rather than any mapping attempt.

## Final Short Summary to Attach

**Red-Team Assessment Summary:**
This report delivers a detailed analytical protocol rather than completed results. Despite sophisticated methodological design and transparent acknowledgment of limitations, it fails to satisfy core task requirements: no scores were computed, no transition window was identified, and no targets were validated with dataset-specific evidence. The proposed scoring approach has statistical limitations (conflation of effect size and power, potential circularity in transition detection), and the aging-like specificity filter may not adequately distinguish from generic stress responses. Target gene proposals rely on prior mechanistic knowledge rather than emerging from the provided data. The report would require full execution with actual DEG tables to meet the assignment's evidentiary standards. Current reliability is limited to the soundness of the proposed framework, not to any scientific conclusions about T cell exhaustion-aging trajectories or rejuvenation targets.

---