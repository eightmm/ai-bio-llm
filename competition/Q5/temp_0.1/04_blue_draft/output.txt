(A) Quantification of Exhaustion and Aging-Like Programs
---

### A.1 Inputs and what to compute from the provided files
**Input files**
1. `Q5.maryphilip_metadata.csv` (10 rows): provides `day`, `day_num`, `condition`, `category`, `source`.
2. Six DEG summary tables (36,255 genes each; columns include `log2FoldChange`, `padj`, and `meanTPM_[condition]`):
   - Day 5: `L5 vs E5`
   - Day 7: `L7 vs E7`
   - Day 14: `L14 vs L7`
   - Day 21: `L21 vs L14`
   - Day 35: `L35 vs L14`
   - Day 60: `L60 vs L14`

**Preprocessing (mandatory for correct merging)**
1. Harmonize the gene identifier column across DEG files (`gene_name` vs `Unnamed: 0`) into a single column, e.g., `gene`.
2. Keep, at minimum, per gene per contrast: `log2FoldChange`, `padj`, and all `meanTPM_*` columns.
3. (Abundance filter for stability) Keep genes with `max(meanTPM_*) >= 1` within each DEG file before signature derivation (TPM-based reliability heuristic).

**Key limitation of the provided data format (must be acknowledged)**
- The DEG files are *contrast-level summaries*, not sample-level matrices. Therefore, program “scores” cannot be computed per individual sample via ssGSEA/GSVA unless raw/sample-level TPM is separately available. Below, scores are defined in a **contrast-based** way (program activation per time-contrast), which is still grounded in the RNA-seq evidence provided (log2FC/padj).

---

### A.2 Define an exhaustion score from the time-course data (data-derived signature)
**Goal:** derive an exhaustion program directly from genes that separate “late vs early” at early timepoints and/or increase along the later L-time trajectory.

**Step A (signature gene set construction)**
1. In the **Day 5** table (`L5 vs E5`), define candidate exhaustion-up genes:
   - `padj < 0.05` and `log2FoldChange > 0` (up in L relative to E).
2. In the **Day 7** table (`L7 vs E7`), define candidate exhaustion-up genes similarly.
3. Define the **exhaustion gene set** as the *intersection* of the Day 5 and Day 7 exhaustion-up lists (stability criterion across early timepoints).
4. Optionally (but recommended for biological anchoring), ensure inclusion if present and expressed (TPM filter) of canonical exhaustion regulators/markers such as: `PDCD1`, `LAG3`, `HAVCR2`, `CTLA4`, `TIGIT`, `TOX`, `EOMES`, `PRDM1`, `NR4A1/2/3`.  
   - **Important:** only treat them as part of the signature if they are actually present in the DEG tables and pass abundance filtering; do not assume significance without checking `padj/log2FC`.

**Step B (contrast-based exhaustion score)**
For each contrast \(c\) (Day 5, 7, 14, 21, 35, 60), compute:
- **ExhaustionScore(c)** = mean of `log2FoldChange` over exhaustion signature genes (optionally restricted to those significant in that contrast, e.g., `padj < 0.05`, to avoid noise).

This yields a *trajectory of exhaustion program activation across contrasts*.

---

### A.3 Define an aging-like score using aging/senescence resources + time-course overlap
**Goal:** quantify emergence of aging-like/senescence-like stress programs along later timepoints.

**Step A (candidate aging gene universe)**
Construct an **aging-like candidate set** by union of:
- GenAge genes (human aging genomic resources)
- MSigDB aging/senescence-related gene sets (e.g., aging-up/down, senescence/SASP, DNA damage response–linked senescence sets)

**Step B (refine to what is actually changing in this dataset)**
Because the axis here is “Exhaustion → Aging-like → Death”, aging-like should emerge later than early L-vs-E separation. Use later contrasts vs Day 14 baseline:
- For each of `L21 vs L14`, `L35 vs L14`, `L60 vs L14`, select genes with:
  - `padj < 0.05` and `log2FoldChange > 0` (aging-up-in-time candidates)
- Intersect these significant-up genes with the aging-like candidate set above.
- Optionally define an **aging-down** set analogously (`padj < 0.05` and `log2FoldChange < 0`, intersected with MSigDB aging-down sets or mitochondrial/translation sets if using curated aging-down lists).

**Step C (contrast-based aging-like score)**
For each contrast \(c\):
- **AgingLikeScore(c)** = mean `log2FoldChange` over aging-up genes  
  (optionally minus mean `log2FoldChange` over aging-down genes, if you define both).

---

### A.4 Visualize and describe how these scores change over time
**What to plot (minimum)**
1. **Line plot across contrasts** (x-axis labeled by day/contrast; y-axis score):
   - ExhaustionScore for: Day5 (L5–E5), Day7 (L7–E7), Day14 (L14–L7), Day21 (L21–L14), Day35 (L35–L14), Day60 (L60–L14)
   - AgingLikeScore for the same contrasts
2. **Scatter plot** of ExhaustionScore vs AgingLikeScore across contrasts to show whether aging-like activation “lags” exhaustion.

**How to describe the trend (grounded interpretation rule)**
- After computing the plots above, describe:
  - whether ExhaustionScore is already elevated in early L vs E contrasts (Day 5/7),
  - whether AgingLikeScore is minimal early and increases primarily in later contrasts (21/35/60 vs 14),
  - whether the rise in AgingLikeScore coincides with decreases in an effector/fitness proxy (optional; see below).

**Optional reciprocal program (recommended to strengthen the “rejuvenation” framing)**
Define an **Effector/Fitness score** as mean log2FC over cytotoxic/memory/mitochondrial fitness genes (only if present/expressed), e.g., `TCF7`, `IL7R`, `CCR7`, `PRF1`, `GZMB` (context-dependent), and mitochondrial biogenesis/ETC genes. Plot:
- ProgressionAxis(c) = ExhaustionScore(c) + AgingLikeScore(c) − EffectorFitnessScore(c)

---

(B) Identification of the Critical Transition Window
---

### B.1 Define a key transition window along “Exhaustion → Aging-Like → Death”
**Operational definition (change-point on program scores)**
1. Compute **ΔAgingLikeScore** between adjacent *available* later contrasts around Day 14:
   - Primary comparison available for adjacency is **Day14→Day21** via `L21 vs L14`.
2. Define the **critical transition window** as the earliest interval where:
   - AgingLikeScore shows its **first strong positive activation** relative to the Day 14 baseline, and
   - ExhaustionScore remains high or continues increasing, and
   - (if computed) Effector/Fitness score decreases.

**With the provided contrast structure, the biologically most testable transition window is:**
- **Day 14 to Day 21** (using `L21 vs L14`)  
because Day 14 is the baseline for all later timepoints (21/35/60), making it the pivot where “late dysfunction programs” can be detected as new emergence rather than continued early divergence (Day 5/7).

---

### B.2 Justify why this interval is a meaningful state transition (not just a continuum)
Use **three RNA-seq–based criteria** that can be computed directly from the DEG tables:

1. **Program-level acceleration (score slope change)**
   - Fit a piecewise model on AgingLikeScore across later contrasts (14→21→35→60, relative to Day 14 baseline), and test whether the first segment (14→21) has a substantially higher slope than expected from noise (e.g., largest absolute Δ among later contrasts).
   - In practice with only three later contrasts vs baseline, a simpler criterion is acceptable: **Day21 shows the largest jump in AgingLikeScore** compared with later increments.

2. **Qualitative turnover of leading genes (module/leading-edge proxy)**
   - Compare the top N (e.g., 50–200) most significant upregulated genes (`padj` smallest, `log2FC` positive) in `L21 vs L14` versus those in `L35 vs L14` and `L60 vs L14`.
   - A “transition” is supported if **Day 21 introduces a distinct set enriched for stress/senescence/DNA-damage/apoptosis-related genes**, rather than being a simple scaled version of later timepoints.

3. **Emergence of senescence/death-associated pathways**
   - Run enrichment on `L21 vs L14` upregulated genes for:
     - DNA damage response / p53-p21 axis markers (e.g., `CDKN1A`, DNA repair sensors)
     - inflammatory/SASP-like cytokine programs (context-dependent in T cells)
     - apoptosis/cell death signaling (FAS/FASL axis, BCL2-family shifts)
   - A significant enrichment specifically appearing at Day 21 (and then persisting) supports a *state change* rather than gradual drift.

**Limitation**
- Bulk RNA-seq contrasts cannot distinguish whether the “transition” reflects (i) within-cell reprogramming or (ii) shifts in mixture/composition of T cell sub-states. This should be stated when interpreting “death” or “senescence” as transcriptional programs.

---

(C) Proposal of Rejuvenation Target Genes
---

### C.1 Target selection rule (must be satisfied from the DEG tables)
A proposed rejuvenation target gene should satisfy **at least one** of the following RNA-seq patterns centered on the transition window (Day 14→21):

**Pattern 1 (putative driver to inhibit):**
- Upregulated at/after transition: `log2FC(L21 vs L14) > 0` with `padj < 0.05`, and ideally remains up in `L35 vs L14` and/or `L60 vs L14`.
- Positively aligned with ExhaustionScore and/or AgingLikeScore (computed as in part A).

**Pattern 2 (fitness factor to activate):**
- Downregulated at/after transition: `log2FC(L21 vs L14) < 0` with `padj < 0.05`, consistent at later timepoints.
- Negatively aligned with Exhaustion/AgingLike scores and positively aligned with Effector/Fitness score (if computed).

**Priority weighting**
- Transcription factors, chromatin regulators, and signaling/metabolic control points are prioritized over terminal markers.

---

### C.2 Candidate targets (with intervention direction and how the RNA-seq evidence should look)
Because the prompt requires gene-level proposals specifically tied to RNA-seq directionality, each target below is presented with: (i) **direction**, (ii) **what to verify in the provided DEG files**, (iii) **pathway/network context**, and (iv) **expected rejuvenation-like shift**.  
**Note:** the exact log2FC/padj values must be read from your DEG CSVs; they are not contained in the provided analysis summary.

#### Target 1: TOX — **Inhibition**
- **RNA-seq evidence to extract**
  - Check `TOX` in: `L7 vs E7`, `L14 vs L7`, and especially `L21 vs L14`, `L35 vs L14`, `L60 vs L14`.
  - Supportive pattern: significant upregulation (positive log2FC, `padj < 0.05`) that persists into later timepoints.
- **Network/pathway context**
  - Transcriptional regulator tightly coupled to the exhaustion regulatory program; expected to sit in the same co-expression neighborhood as inhibitory receptors (`PDCD1`, `LAG3`, `HAVCR2`, `TIGIT`) if those are up.
- **Opposing regulation relative to signatures**
  - If TOX is up when ExhaustionScore/AgingLikeScore rise, inhibiting TOX is predicted to reduce those scores.
- **Expected rejuvenation-like transcriptional shift**
  - Decrease in exhaustion module genes and relative restoration of memory/fitness genes (e.g., `TCF7`, `IL7R`) if they are suppressed in your contrasts.

#### Target 2: RUNX2 — **Inhibition**
- **RNA-seq evidence to extract**
  - Check `RUNX2` in `L21 vs L14` (transition) and persistence in `L35/L60 vs L14`.
  - Supportive pattern: induction beginning at Day 21 and/or increasing thereafter.
- **Network/pathway context**
  - Transcription factor associated with state transitions toward more terminal differentiation programs in exhausted T cells.
- **Opposing regulation**
  - If RUNX2 tracks with AgingLikeScore increase (14→21), inhibition is predicted to blunt the exhaustion→aging-like handoff.
- **Expected shift**
  - Lower terminal/exhaustion-associated transcriptional state intensity; preservation of earlier/progenitor-like features in the expression landscape (as measured by your exhaustion/effector reciprocal scoring).

#### Target 3: NR4A3 — **Inhibition (context-dependent but testable here)**
- **RNA-seq evidence to extract**
  - Evaluate `NR4A3` (and optionally `NR4A1/NR4A2`) across contrasts:
    - early activation/exhaustion separation: `L5 vs E5`, `L7 vs E7`
    - later aging-like emergence: `L21 vs L14` and beyond
  - Supportive “exhaustion-locking” pattern: re-induction or sustained elevation at/after Day 21 alongside aging-like activation.
- **Network/pathway context**
  - Immediate-early/TCR-responsive transcription factor family; chronic induction can couple persistent stimulation to exhaustion circuitry.
- **Opposing regulation**
  - If NR4A3 is elevated specifically when Effector/Fitness score drops and AgingLikeScore rises, inhibition supports rejuvenation.
- **Expected shift**
  - Reduced chronic-stimulation transcriptional imprinting and partial restoration of effector competence signatures (dataset-dependent).

#### Target 4: HIF1A (and/or its glycolysis effector node PFKFB3) — **Inhibition**
- **RNA-seq evidence to extract**
  - Because HIF1A activity can be reflected by target enzymes, check:
    - `HIF1A` itself and glycolysis genes such as `PFKFB3`, `LDHA`, `SLC2A1` (GLUT1) in `L21 vs L14`, `L35 vs L14`, `L60 vs L14`.
  - Supportive pattern: coordinated upregulation of glycolysis module genes starting at Day 21.
- **Network/pathway context**
  - Metabolic reprogramming node linking hypoxia/stress and glycolytic commitment; relevant because “aging-like” dysfunction is commonly associated with metabolic stress.
- **Opposing regulation**
  - If glycolysis module activation coincides with AgingLikeScore increase, inhibiting this axis is predicted to push transcription away from the aging-like stress state.
- **Expected shift**
  - Lower metabolic stress/inflammatory transcriptional features and relative recovery of mitochondrial/fitness gene expression (if those are declining).

#### Target 5: TFAM (mitochondrial maintenance) — **Activation / restoration**
- **RNA-seq evidence to extract**
  - Check `TFAM` in `L21 vs L14`, `L35 vs L14`, `L60 vs L14`.
  - Supportive pattern: downregulation after Day 14 (negative log2FC, significant), consistent with declining mitochondrial fitness.
- **Network/pathway context**
  - Mitochondrial biogenesis/mtDNA maintenance regulator; fits the “aging-like” axis where mitochondrial decline is a recurrent hallmark.
- **Opposing regulation**
  - If TFAM decreases as AgingLikeScore increases, then activation is aligned with reversing the aging-like shift.
- **Expected shift**
  - Increased expression of OXPHOS/mitochondrial translation programs (as detectable in your DEG tables), and improved Effector/Fitness score.

#### Target 6 (higher risk / lower priority): CDKN1A (p21) — **Inhibition is NOT generally recommended; use as a transition marker and upstream-targeting readout**
- **RNA-seq evidence to extract**
  - Check `CDKN1A` induction at `L21 vs L14` and persistence at later timepoints.
  - A sharp increase supports that the Day 14→21 window captures senescence-like cell-cycle arrest signaling.
- **Network/pathway context**
  - DNA damage/p53-p21 axis; often marks senescence-like arrest.
- **Opposing regulation**
  - p21 up is aligned with aging-like score; however, directly inhibiting it can be unsafe because it may permit survival/propagation of damaged cells.
- **How to use for rejuvenation logic**
  - Use **reduction of CDKN1A induction** as a *readout* that upstream interventions (e.g., reducing metabolic stress via HIF1A/glycolysis inhibition and restoring mitochondria via TFAM activation) are moving cells away from the aging-like/senescent trajectory.

---

### C.3 Practical “evidence card” outputs to include for each target (what you should report from the CSVs)
For each proposed target gene, extract and report directly from the DEG tables:
1. **Direction over time**: the sign and magnitude of `log2FoldChange` at:
   - Day 7 (L7 vs E7), Day 14 (L14 vs L7), Day 21 (L21 vs L14), Day 35 (L35 vs L14), Day 60 (L60 vs L14)
2. **Significance**: `padj` at the same contrasts.
3. **Context module** (bulk proxy): whether the gene is part of your exhaustion signature set, aging-like signature set, glycolysis module, mitochondrial/fitness module (as defined in part A).
4. **Opposition to rejuvenation**: show that inhibiting an “up” driver or activating a “down” fitness gene would mathematically reduce your ProgressionAxis score.

---

(D) Optional (Bonus): Therapeutic Mapping
---

### D.1 What can/cannot be done with the provided inputs
- The prompt specifies “using the provided drug–target dataset,” but **no drug–target dataset is included in the provided inputs here**. Therefore, a systematic mapping (target → compound list) cannot be completed reproducibly from the supplied files alone.

### D.2 Feasible mapping procedure (once a drug–target table is provided)
For each target (e.g., TOX, RUNX2, NR4A3, HIF1A/PFKFB3, TFAM):
1. Standardize identifiers (HGNC symbol ↔ UniProt/Entrez).
2. Join against drug–target table by target ID.
3. Filter for mechanism consistent with desired direction:
   - inhibitors/antagonists for TOX/RUNX2/NR4A3/HIF1A/PFKFB3
   - activators/agonists/biogenesis enhancers for TFAM axis
4. Output: drug name, MoA, approval stage, specificity flags, and whether expression is T-cell selective (if annotations exist).

### D.3 General feasibility limitations (should be stated even after mapping)
- Many high-priority nodes here are transcription factors (TOX, RUNX2, NR4A3) and may lack direct small-molecule modulators; genetic/ex vivo engineering or indirect pathway targeting may be more practical.
- Systemic metabolic inhibitors (e.g., HIF/glycolysis axis) risk suppressing normal T cell activation if timed too early; the transition window definition (Day 14→21) is therefore central to any intervention concept.

---

**Overall assumptions/limitations (applies to A–D)**
1. DEG contrasts are treated as proxies for program activation because sample-level expression matrices are not provided.
2. “Death” is inferred only via transcriptional programs (apoptosis/stress signatures), not by direct viability assays.
3. Bulk RNA-seq cannot separate within-cell reprogramming from compositional shifts in T cell subsets across timepoints; any rejuvenation inference should be validated with cell-state–resolved data if available.