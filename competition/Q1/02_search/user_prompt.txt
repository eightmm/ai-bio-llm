# Problem Context
You are given structured information describing a scientific research problem.

## Problem Description
Problem 1. [Troubleshooting an Ribosome Profiling Experiment]
You are given a ribosome profiling (Ribo-seq) wet-lab protocol and a set of incident reports from teams who attempted the workflow. Your job is to diagnose the root causes, propose fixes, and design a validation and prevention plan.

Provided artifact

-	protocol.md: The protocol “as distributed” to teams.
-	reference.fa: a single transcript reference sequence (toy_gene).
-	reads.fastq.gz: 50-nt single-end reads (a few hundred total).

Constraints

-	Assume no ability to run new wet-lab experiments during the competition.
-	You may propose additional experiments/QC as recommendations, but your core answers must be supported by the protocol text and the incident reports below.

Background (what “good” usually looks like)
Ribo-seq aims to sequence ribosome-protected RNA fragments. Typical success indicators include:

-	A narrow protected-fragment size distribution after digestion/selection (often ~28–34 nt; may vary by system).
-	Clear enrichment of coding-region signal and strong 3-nt periodicity in aligned reads.
-	A clean final library trace (dominant peak at expected library size, limited adapter/primer-dimer).
-	Reasonable PCR duplication; if UMIs are present, deduplication should not saturate at extremely small numbers of unique UMIs.

This protocol also encodes a UMI in the adapter/read structure (random bases denoted by N).

Competition framing
There are several issues across the incidents:

-	Some are protocol/document defects present in the originally distributed protocol.
-	There are some execution mistakes (not written in the protocol) by the experimenter. Only observations that may be derived from the mistakes are documented.

Sub-Problems
1-1. Incident A
Task: Based on the report and observations, propose the most likely root cause(s) and the next steps to confirm and fix the issue.

User report

“We followed the protocol end-to-end, but the final libraries are kind of messy and the yield jumps around between runs. Sometimes we get a decent peak; other times it’s smeary and hard to quantify.”

Observations

-	TapeStation/Bioanalyzer traces show a main library peak plus elevated baseline/smear and occasional small peaks.
-	qPCR-based quantification shows poor amplification efficiency (steeper Ct variance between replicates than expected).
-	A260/230 (when measured) is low in some runs, suggesting carryover of salts/solvents.
-	Repeating cleanup sometimes improves the trace but not consistently.

1-2. Incident B
Task: Based on the report and observations, propose the most likely root cause(s) and the next steps to confirm and fix the issue.

User report

“Same reagents and same protocol, but different people in the lab get different outcomes. PCR is sometimes fine and sometimes barely works. We didn’t intentionally change anything, so we’re not sure what part is sensitive.”

Observations

-	Strong run-to-run variability depending on operator.
-	PCR sometimes fails or needs extra cycles; when it does amplify, size looks plausible.
-	Repeat attempt with an extended bead air-dry (and careful removal of residual ethanol) restores normal amplification without changing reagents.
-	No single protocol text change explains why only some operators see the issue.

1-3. Incident C
Task: Based on the report and observations, propose the most likely root cause(s) and the next steps to confirm and fix the issue.

User report

“RNA recovery seemed OK, and the library has a peak, but the sequencing results don’t look like our past Ribo-seq runs. The fragments seem bigger than we expected and the usual ‘frame pattern’ isn’t obvious.”

Observations

-	Gel/fragment QC of protected fragments shows a broad distribution with substantial material >40 nt.
-	Sequencing QC:
-	Overall alignment rate is acceptable.
-	3-nt periodicity at P-sites is weak/near-absent.
-	Reads show increased mapping outside CDS compared to prior internal datasets.
-	Library yield after PCR is not obviously low; final library peak exists but downstream interpretability is poor.

1-4. Incident D
Task: Based on the report and observations, propose the most likely root cause(s) and the next steps to confirm and fix the issue.

User report

“The bioinformatics side is giving us strange duplication numbers. After deduplication, it looks like almost everything collapses into a tiny number of molecules, which doesn’t match how much input we started with.”

Observations

-	After UMI extraction, the number of distinct UMIs observed is extremely small.
-	Deduplication collapses a large fraction of reads even in moderately sized datasets.
-	A histogram of observed UMI strings is heavily concentrated in a tiny set; uniqueness saturates early.
-	Downstream quantification across genes is unusually noisy and sensitive to small pipeline changes.

1-5. Incident E
Task: Based on the report and observations, propose the most likely root cause(s) and the next steps to confirm and fix the issue.

User report

“We keep getting mostly short junk products instead of a clean library peak. We tried repeating the run and got basically the same outcome. We did make fresh stocks recently, but we didn’t change anything on purpose.”

Observations

-	A quick denaturing gel check right after the ligation step shows the RNA band at the same position as the pre-ligation control, with no clear shifted product band.
-	The final library trace is dominated by short artifacts; the expected library peak is weak or absent.
-	Replacing enzymes (fresh ligase, fresh buffers) does not reliably recover the expected product; the failure is reproducible across repeats.
-	Input RNA quality metrics (RIN/TapeStation) look acceptable and similar to runs that worked previously.
-	In failed sequencing runs, the first ~20–30 bases of Read 1 are highly enriched for primer/adapter-like sequence, but the expected linker-specific prefix from the protocol appears at very low frequency.
-	The new oligo shipment paperwork differs from prior orders in at least one of: molecule type (RNA vs DNA), terminal modifications, or purification grade (e.g., HPLC vs desalted).
1-6. Preliminary data analysis
You are given a small pilot Ribo-seq dataset focused on a single transcript. Process the raw FASTQ into a per-position footprint count array and summarize what the data suggests.

Expected deliverables

-	counts_raw.csv and counts_dedup.csv: counts per transcript position (state your coordinate convention clearly).
-	A histogram plot showing the distribution of 5' start positions across the transcript (raw and deduplicated side-by-side).
-	A single HTML report that, for this single-transcript dataset, summarizes basic QC suitable for Ribo-seq and your interpretation.
-	A written interpretation: what (if anything) looks biologically meaningful, and 2–4 concrete follow-up checks or next steps.


## Core Objective
Diagnose likely root causes for multiple ribosome profiling (Ribo-seq) workflow failures reported by different teams, using only the distributed wet-lab protocol and the documented incident observations; propose confirmatory checks, fixes, and prevention/validation steps. Additionally, process a small pilot Ribo-seq FASTQ dataset (single-transcript reference) into per-position footprint count arrays (raw and UMI-deduplicated) and summarize QC/interpretation in a concise report.

# Task Details


## Suggested Direction


---

# Task
Using the information above, generate a structured scientific report that addresses the stated problem by synthesizing relevant prior research.


[List of Sub-Problems to Address]
- [1_1_Incident_A] Incident A: Messy library traces, variable yield, and poor qPCR efficiency
  Description: Using the incident report plus the distributed protocol, infer the most likely procedural or protocol-text root cause(s) that explain: (i) smeary/elevated-baseline Bioanalyzer/TapeStation traces with occasional small peaks, (ii) poor/variable qPCR amplification efficiency and replicate Ct variance, (iii) intermittently low A260/230 suggesting contaminant carryover, and (iv) inconsistent improvement after repeating cleanup. Propose a concrete confirmation checklist (what to inspect/measure from existing materials and records) and specific fixes to the workflow (including edits/clarifications to the protocol text). Also propose prevention controls to reduce run-to-run variability.
  Approach: Protocol forensics: locate all cleanup/precipitation/bead-wash steps (AMPure/RNAclean, ethanol washes, column washes, phase-separation, etc.) and identify steps prone to salt/solvent/chaotrope carryover or under/over-drying beads. Map each observation to likely inhibitors (ethanol, guanidinium salts, phenol, high-salt carryover, PEG/bead carryover) and to expected Bioanalyzer signatures (smear/raised baseline, small peaks = adapter/primer-dimer). Recommend confirmatory checks that do not require new wet-lab experiments: review operator notes for bead ratios, wash counts, air-dry timing, elution volumes; re-check A260/230 across intermediate eluates if recorded; examine qPCR amplification curves for inhibition patterns; inspect whether the protocol has ambiguous instructions (e.g., “dry beads” without timing). Propose fixes: standardized bead cleanup parameters (ratios, wash count, mandatory air-dry window), optional second cleanup or size-selection, and an inhibition control (PCR spike-in) plus acceptance criteria for traces. Emphasize prevention: checklist + training + defined hold times and ‘do not overdry’ guidance.

- [1_2_Incident_B] Incident B: Operator-dependent PCR success and recovery after extended bead air-dry
  Description: Using the incident report and protocol, infer the most likely root cause(s) for strong operator-to-operator variability where PCR sometimes fails/needs extra cycles, yet size looks plausible when it amplifies, and where extended bead air-dry/careful ethanol removal restores amplification. Propose confirmatory steps (documentation and/or computational checks) and concrete protocol changes to make the sensitive step robust across operators.
  Approach: Root-cause reasoning anchored on the key clue: improved PCR after extended bead air-dry and ethanol removal strongly implicates ethanol carryover from bead washes (or residual wash buffer) as a PCR inhibitor. Review protocol bead-wash and elution steps for ambiguity: aspiration technique, recommended air-dry duration, residual droplets on tube walls, magnet dwell time, and whether the protocol warns about ethanol inhibition. Confirmation plan: re-examine any available intermediate qPCR data, amplification curves, and notes on bead drying; compare operators’ timing/technique if logged; check whether failures correlate with rushed handling. Fixes: specify a strict ethanol removal SOP (two washes, full supernatant removal, brief spin-down before final aspirate if allowed), define a bounded air-dry window (avoid overdrying), require visual inspection for residual ethanol, and add a small internal PCR control to detect inhibition. Prevention: operator checklist + training, and a ‘stop point’ guidance to avoid leaving beads in ethanol or overdrying.

- [1_3_Incident_C] Incident C: Overlong protected fragments and loss of 3-nt periodicity / CDS enrichment
  Description: Using the incident report and protocol, diagnose likely causes for broad protected-fragment distributions with substantial material >40 nt, acceptable alignment but weak/absent 3-nt periodicity, and increased mapping outside CDS. Provide the most likely wet-lab/protocol-text failure points and propose next steps to confirm and fix, plus prevention/validation checks that teams can apply in future runs.
  Approach: Protocol/biology mapping: identify digestion conditions (RNase I/MNase amount, time, temperature, Mg2+/salt), ribosome stabilization (cycloheximide/harringtonine usage, lysis conditions), and size-selection instructions (gel excision window, bead-based size selection, ladder used). Interpret symptoms: overlong fragments and weak periodicity often indicate under-digestion and/or poor size selection; mapping outside CDS can indicate mRNA contamination, run-off ribosomes, or failure to enrich ribosomes/monosomes. Confirm without new experiments by auditing recorded digestion parameters (enzyme lot/concentration, incubation temp/time, mixing), reviewing gel images/excision ranges if available, and computationally checking read-length distributions and periodicity metrics if any sequencing is available from affected runs (e.g., using RiboWaltz/riboSeqR-style periodicity and metagene profiles). Fixes: clarify digestion setup (enzyme units per A260, mixing, quench), tighten fragment size selection window (explicit nt range and gel region), add acceptance criteria (length peak and fraction >40 nt), and recommend future validation: monosome profile (sucrose gradient or equivalent), rRNA contamination assessment, and a small pilot sequencing QC before scaling.

- [1_4_Incident_D] Incident D: UMI deduplication collapses reads into very few unique molecules
  Description: Using the incident report and protocol, determine the most likely root cause(s) for extremely low observed UMI diversity and aggressive deduplication collapse that is inconsistent with expected input complexity. Propose computational and protocol-level confirmation steps, fixes to the UMI extraction/deduplication pipeline, and prevention measures (including how to validate UMI randomness and correct read-structure parsing).
  Approach: Treat as a read-structure/UMI-design mismatch or oligo/sequence issue. Review protocol.md for the exact adapter/primer structure and where the UMI Ns are located (5' vs 3' of read, inline vs index). Enumerate failure modes: (i) wrong UMI pattern used in extraction (off-by-k bases; extracting constant adapter bases), (ii) UMI Ns not truly random due to synthesis/ordering error (e.g., ‘N’ replaced by fixed bases), (iii) UMI readout not sequenced (UMI located in read segment that is trimmed away or in the other read/index), (iv) low-complexity UMIs caused by short UMI length or biased base composition, (v) deduplication keyed incorrectly (e.g., collapsing across positions/genes incorrectly). Confirmation steps using existing data: inspect raw read prefixes in reads.fastq.gz; compute per-cycle base composition for the putative UMI region; count unique UMIs vs total reads; examine UMI string histogram and entropy; verify adapter-trimming boundaries. Fixes: update UMI extraction with explicit patterns (e.g., umi_tools extract with regex/pattern matching the documented adapter), ensure adapter trimming order is correct, and deduplicate with appropriate keys (UMI + alignment position/strand as appropriate). Prevention: add a simple “UMI randomness QC” metric to the pipeline and require it to pass thresholds before trusting dedup-based quantification.

- [1_5_Incident_E] Incident E: Ligation failure and dominant short artifacts; suspected oligo specification/shipment issue
  Description: Using the incident report, protocol, and the provided clues about changed oligo shipment attributes, infer the most likely root cause(s) for: no post-ligation shift on denaturing gel, final library dominated by short artifacts, lack of expected linker-specific prefix in Read 1, reproducible failure despite enzyme replacement, and paperwork differences (RNA vs DNA, terminal modifications, purification grade). Propose concrete confirmation checks (including computational checks from failed sequencing data if available) and specific corrective actions and prevention steps for future ordering/QC.
  Approach: Protocol-to-chemistry verification: identify which ligation (3' adapter to RNA fragment, 5' adapter, circularization) is implicated by the ‘no shifted band after ligation’ observation, and list required oligo properties (RNA vs DNA adapter, 5' phosphate, 3' blocking group, pre-adenylation if using truncated ligase, etc.). Map failure to likely mis-specified oligos: wrong molecule type (DNA adapter in RNA ligation context), missing 5' phosphate/adenylation, incorrect 3' modification, incompatible terminal chemistry, or inadequate purification leading to truncated products/adapter artifacts. Confirmation plan without new wet-lab: reconcile ordered oligo sequences/modifications against protocol requirements; examine failed-run FASTQ for presence/absence of expected linker prefix, adapter-dimer signatures, and read-start composition; check whether reads predominantly match primer/adapter rather than insert. Fixes: re-order adapters with correct chemistry/purification explicitly specified; update protocol with a procurement checklist and acceptance criteria (vendor, part number, required mods, purification). Prevention: incoming oligo QC steps (documentation review, small computational prefix check on a tiny test run, and a positive-control ligation recommendation for future non-competition runs).

- [1_6_Preliminary_Data_Analysis] Pilot Ribo-seq data processing on a single transcript: per-position footprint counts, UMI dedup, QC report
  Description: Process reads.fastq.gz against reference.fa (single transcript) into per-position footprint count arrays for (i) raw reads and (ii) UMI-deduplicated reads, producing counts_raw.csv and counts_dedup.csv. Clearly state coordinate convention (e.g., 1-based transcript positions of the read 5' start; specify whether positions refer to transcript sequence indices). Generate a histogram plot of 5' start positions across the transcript for raw vs deduplicated data (side-by-side). Produce a single HTML report summarizing basic Ribo-seq QC appropriate for this toy single-transcript dataset (read length distribution, adapter/UMI structure sanity checks, mapping rate, duplication/UMI complexity, 5' start distribution, any periodicity signal if inferable). Provide a written interpretation: what (if anything) is biologically meaningful, plus 2–4 concrete follow-up checks/next steps.
  Approach: Implement a lightweight, reproducible pipeline (Python/R + standard CLI tools). Steps: (1) Read QC (fastp/FastQC) and adapter detection; (2) UMI extraction per protocol.md (umi_tools extract or cutadapt with inline UMI handling); (3) Adapter/quality trimming (cutadapt/fastp), retaining insert; (4) Align to reference.fa with a short-read aligner suitable for small references (bowtie2 in end-to-end or local mode; or minimap2 -x sr), capturing strand and 5' start. (5) Compute per-position 5' start counts across transcript (raw and after umi_tools dedup; define dedup key as UMI + alignment start (+ strand if relevant)). (6) Export CSVs with columns like: position, count; include metadata header or README snippet in report stating coordinate convention and transcript length. (7) Plot histograms of 5' starts (raw vs dedup) and summarize UMI complexity (unique UMIs, entropy, saturation curve). (8) Optional Ribo-seq QC: if ORF coordinates are known/derivable for toy_gene, attempt simple 3-nt periodicity check by modulo of inferred P-site offset; if not, report that periodicity inference is limited by single-transcript toy setup and unknown CDS annotation. (9) Render an HTML report (Quarto/RMarkdown/Jupyter->HTML) bundling figures, tables, and interpretation with recommended next checks (e.g., verify UMI randomness region, verify adapter prefix frequency, check read-length peak vs expected footprint length, evaluate start-position clustering that might indicate nuclease/ligation bias).

