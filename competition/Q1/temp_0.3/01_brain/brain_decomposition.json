{
  "original_problem_text": "Problem 1. [Troubleshooting an Ribosome Profiling Experiment]\nYou are given a ribosome profiling (Ribo-seq) wet-lab protocol and a set of incident reports from teams who attempted the workflow. Your job is to diagnose the root causes, propose fixes, and design a validation and prevention plan.\n\nProvided artifact\n\n-\tprotocol.md: The protocol “as distributed” to teams.\n-\treference.fa: a single transcript reference sequence (toy_gene).\n-\treads.fastq.gz: 50-nt single-end reads (a few hundred total).\n\nConstraints\n\n-\tAssume no ability to run new wet-lab experiments during the competition.\n-\tYou may propose additional experiments/QC as recommendations, but your core answers must be supported by the protocol text and the incident reports below.\n\nBackground (what “good” usually looks like)\nRibo-seq aims to sequence ribosome-protected RNA fragments. Typical success indicators include:\n\n-\tA narrow protected-fragment size distribution after digestion/selection (often ~28–34 nt; may vary by system).\n-\tClear enrichment of coding-region signal and strong 3-nt periodicity in aligned reads.\n-\tA clean final library trace (dominant peak at expected library size, limited adapter/primer-dimer).\n-\tReasonable PCR duplication; if UMIs are present, deduplication should not saturate at extremely small numbers of unique UMIs.\n\nThis protocol also encodes a UMI in the adapter/read structure (random bases denoted by N).\n\nCompetition framing\nThere are several issues across the incidents:\n\n-\tSome are protocol/document defects present in the originally distributed protocol.\n-\tThere are some execution mistakes (not written in the protocol) by the experimenter. Only observations that may be derived from the mistakes are documented.\n\nSub-Problems\n1-1. Incident A\nTask: Based on the report and observations, propose the most likely root cause(s) and the next steps to confirm and fix the issue.\n\nUser report\n\n“We followed the protocol end-to-end, but the final libraries are kind of messy and the yield jumps around between runs. Sometimes we get a decent peak; other times it’s smeary and hard to quantify.”\n\nObservations\n\n-\tTapeStation/Bioanalyzer traces show a main library peak plus elevated baseline/smear and occasional small peaks.\n-\tqPCR-based quantification shows poor amplification efficiency (steeper Ct variance between replicates than expected).\n-\tA260/230 (when measured) is low in some runs, suggesting carryover of salts/solvents.\n-\tRepeating cleanup sometimes improves the trace but not consistently.\n\n1-2. Incident B\nTask: Based on the report and observations, propose the most likely root cause(s) and the next steps to confirm and fix the issue.\n\nUser report\n\n“Same reagents and same protocol, but different people in the lab get different outcomes. PCR is sometimes fine and sometimes barely works. We didn’t intentionally change anything, so we’re not sure what part is sensitive.”\n\nObservations\n\n-\tStrong run-to-run variability depending on operator.\n-\tPCR sometimes fails or needs extra cycles; when it does amplify, size looks plausible.\n-\tRepeat attempt with an extended bead air-dry (and careful removal of residual ethanol) restores normal amplification without changing reagents.\n-\tNo single protocol text change explains why only some operators see the issue.\n\n1-3. Incident C\nTask: Based on the report and observations, propose the most likely root cause(s) and the next steps to confirm and fix the issue.\n\nUser report\n\n“RNA recovery seemed OK, and the library has a peak, but the sequencing results don’t look like our past Ribo-seq runs. The fragments seem bigger than we expected and the usual ‘frame pattern’ isn’t obvious.”\n\nObservations\n\n-\tGel/fragment QC of protected fragments shows a broad distribution with substantial material >40 nt.\n-\tSequencing QC:\n-\tOverall alignment rate is acceptable.\n-\t3-nt periodicity at P-sites is weak/near-absent.\n-\tReads show increased mapping outside CDS compared to prior internal datasets.\n-\tLibrary yield after PCR is not obviously low; final library peak exists but downstream interpretability is poor.\n\n1-4. Incident D\nTask: Based on the report and observations, propose the most likely root cause(s) and the next steps to confirm and fix the issue.\n\nUser report\n\n“The bioinformatics side is giving us strange duplication numbers. After deduplication, it looks like almost everything collapses into a tiny number of molecules, which doesn’t match how much input we started with.”\n\nObservations\n\n-\tAfter UMI extraction, the number of distinct UMIs observed is extremely small.\n-\tDeduplication collapses a large fraction of reads even in moderately sized datasets.\n-\tA histogram of observed UMI strings is heavily concentrated in a tiny set; uniqueness saturates early.\n-\tDownstream quantification across genes is unusually noisy and sensitive to small pipeline changes.\n\n1-5. Incident E\nTask: Based on the report and observations, propose the most likely root cause(s) and the next steps to confirm and fix the issue.\n\nUser report\n\n“We keep getting mostly short junk products instead of a clean library peak. We tried repeating the run and got basically the same outcome. We did make fresh stocks recently, but we didn’t change anything on purpose.”\n\nObservations\n\n-\tA quick denaturing gel check right after the ligation step shows the RNA band at the same position as the pre-ligation control, with no clear shifted product band.\n-\tThe final library trace is dominated by short artifacts; the expected library peak is weak or absent.\n-\tReplacing enzymes (fresh ligase, fresh buffers) does not reliably recover the expected product; the failure is reproducible across repeats.\n-\tInput RNA quality metrics (RIN/TapeStation) look acceptable and similar to runs that worked previously.\n-\tIn failed sequencing runs, the first ~20–30 bases of Read 1 are highly enriched for primer/adapter-like sequence, but the expected linker-specific prefix from the protocol appears at very low frequency.\n-\tThe new oligo shipment paperwork differs from prior orders in at least one of: molecule type (RNA vs DNA), terminal modifications, or purification grade (e.g., HPLC vs desalted).\n1-6. Preliminary data analysis\nYou are given a small pilot Ribo-seq dataset focused on a single transcript. Process the raw FASTQ into a per-position footprint count array and summarize what the data suggests.\n\nExpected deliverables\n\n-\tcounts_raw.csv and counts_dedup.csv: counts per transcript position (state your coordinate convention clearly).\n-\tA histogram plot showing the distribution of 5' start positions across the transcript (raw and deduplicated side-by-side).\n-\tA single HTML report that, for this single-transcript dataset, summarizes basic QC suitable for Ribo-seq and your interpretation.\n-\tA written interpretation: what (if anything) looks biologically meaningful, and 2–4 concrete follow-up checks or next steps.\n",
  "problem_id": "ribo_seq_troubleshooting",
  "main_problem_definition": "Diagnose root causes of multiple reported failures in a ribosome profiling (Ribo-seq) workflow by cross-referencing a distributed wet-lab protocol with incident observations, then propose fixes plus validation/prevention plans. Additionally, process a small pilot single-transcript Ribo-seq FASTQ dataset (with UMI structure defined by the protocol) into per-position footprint counts (raw and deduplicated) and summarize QC/interpretation in an HTML report.",
  "sub_problems": [
    {
      "id": "1_1_Incident_A",
      "title": "Incident A: Messy library traces, variable yield, poor qPCR efficiency",
      "description": "Using the protocol and the Incident A observations, identify the most likely root cause(s) for smeary/variable library traces and inconsistent yield. Propose a short list of the highest-probability failure modes, then specify concrete confirmation checks that can be performed without new wet-lab runs (e.g., inspection of intermediate QC records, reagent handling logs, trace patterns), plus wet-lab validation steps to recommend for future runs. Provide specific protocol edits (wording/steps) to prevent recurrence.",
      "suggested_approach": "Protocol forensics + failure-mode mapping: (1) Parse protocol.md for all cleanup/precipitation/bead steps, ethanol washes, salt-containing buffers, and gel-extraction/column steps that could explain low A260/230 and PCR inhibition. (2) Map each observation to typical causes: elevated baseline/smear and occasional small peaks -> adapter/primer-dimer carryover, partial size selection, or mixed products; low A260/230 -> guanidinium/phenol/ethanol/salt carryover; qPCR efficiency/replicate Ct variance -> inhibitors or variable bead carryover. (3) Propose confirmatory checks: review TapeStation region around adapter-dimer, compare traces before/after cleanup; check whether sample-specific bead ratios or elution volumes varied; examine any recorded bead-dry times and ethanol freshness; inspect whether a second cleanup systematically shifts library size distribution. (4) Fixes: standardize bead ratio and mixing, add explicit “remove residual ethanol” and “do not overdry” criteria, add optional second cleanup or PEG/NaCl-based size selection, recommend using qPCR inhibitor-tolerant polymerase if needed. (5) Prevention: add a checklist + acceptance criteria for A260/230, and a decision tree for repeating cleanup vs re-prep.",
      "DB_flag": 1,
      "DB_list": "protocol.md"
    },
    {
      "id": "1_2_Incident_B",
      "title": "Incident B: Operator-dependent PCR success rescued by longer bead air-dry",
      "description": "From the protocol and Incident B observations, infer the most likely root cause(s) that explain strong operator-to-operator variability and PCR inhibition that is rescued by extended bead air-drying and careful ethanol removal. Specify the minimum set of confirmation checks and protocol modifications that would make the step robust across operators, including objective endpoints (time, visual cues, volume checks).",
      "suggested_approach": "Root-cause inference anchored on the ‘air-dry fixes it’ clue: (1) Locate in protocol.md all SPRI/bead cleanup steps prior to PCR and identify where residual ethanol could carry over into PCR. (2) Interpret observation pattern as ethanol carryover and/or bead carryover inhibiting amplification; explain why different operators differ (pipetting angle, aspiration aggressiveness, wash timing). (3) Confirmation without new wet-lab: ask for/inspect operator notes (dry times, ethanol concentration used, whether beads cracked/overdried), and compare run metadata to outcomes. (4) Fixes: add explicit dry-time range + objective endpoint (e.g., no visible sheen, no ethanol odor, beads still glossy-not-cracked), specify aspiration technique, add a brief post-wash spin and second aspiration step if compatible, and specify elution incubation time. (5) Prevention/validation: recommend a simple internal control PCR or spike-in to detect inhibition; add training notes and photos to protocol.",
      "DB_flag": 1,
      "DB_list": "protocol.md"
    },
    {
      "id": "1_3_Incident_C",
      "title": "Incident C: Overlong protected fragments and weak 3-nt periodicity",
      "description": "Use the protocol and Incident C observations to propose the most likely root cause(s) for broad/overlong footprint size distribution (>40 nt), increased non-CDS mapping, and weak/absent 3-nt periodicity despite acceptable alignment and decent library yield. Provide a prioritized diagnostic/confirmation plan (computational checks now; recommended wet-lab validation later) and specific protocol fixes (digestion, size selection, ribosome isolation, or library construction).",
      "suggested_approach": "Ribo-seq interpretability triage: (1) Protocol audit: identify nuclease type/amount/time/temp, digestion quench conditions, monosome isolation steps, and size-selection window definition—flag any ambiguous or error-prone wording. (2) Hypotheses linking observations: incomplete/inefficient nuclease digestion (or wrong enzyme/buffer) -> longer fragments and weaker periodicity; overly broad gel cut/bead size selection -> retains >40 nt; contamination by non-ribosome-protected fragments (e.g., fragmented mRNA, RNPs) -> non-CDS mapping. (3) In-silico confirmation: from existing sequencing reads (if accessible to the team) check read-length distribution, periodicity by read length, frame preference vs inferred ORF, and positional enrichment around start/stop; test whether restricting to 28–34 nt restores periodicity. (4) Fixes: specify digestion optimization ladder (RNase concentration/time), enforce narrow size-selection window with explicit gel coordinates/ladder references, recommend monosome purification consistency. (5) Prevention: add go/no-go QC gates (post-digestion fragment analyzer window; post-size selection length check) before library amplification.",
      "DB_flag": 1,
      "DB_list": "protocol.md"
    },
    {
      "id": "1_4_Incident_D",
      "title": "Incident D: UMI deduplication collapses to tiny number of molecules",
      "description": "Diagnose why UMI diversity is extremely low and deduplication collapses most reads, using the protocol-defined read/adapter/UMI structure and the Incident D observations. Propose confirmation steps (primarily computational inspection of raw reads and extracted UMIs) and fixes spanning both wet-lab (oligo design/ordering) and bioinformatics (UMI extraction/trimming/dedup logic). Include prevention steps (spec checks for UMI complexity; pipeline unit tests).",
      "suggested_approach": "UMI pathology analysis: (1) Extract from protocol.md the intended UMI placement (5' vs 3', length, whether in Read 1 sequence or index read, and exact adapter/linker layout). (2) Enumerate likely causes: wrong oligo synthesis (UMI region not actually randomized), wrong read segment extracted as UMI (e.g., constant linker bases), trimming removes UMI before extraction, UMI length too short, low-quality basecalling collapsing to few strings, or sample index/UMI confusion. (3) Confirmation (no new wet-lab): inspect raw FASTQ for the expected constant motifs flanking the UMI; compute per-position base composition/entropy across the UMI window; histogram top UMI sequences and check for motif-like enrichment; verify UMI-tools/fgbio extraction parameters match protocol. (4) Fixes: correct extraction order (extract-then-trim), correct coordinates and strandedness, require minimum base qualities, update adapter sequences; if wet-lab: reorder correct randomized oligo with explicit N count and high-quality synthesis/purification. (5) Prevention: add a pre-dedup QC module (UMI entropy threshold, expected 4^N occupancy curves) and small simulated-read tests for the pipeline.",
      "DB_flag": 1,
      "DB_list": "protocol.md"
    },
    {
      "id": "1_5_Incident_E",
      "title": "Incident E: Ligation failure and short junk products after new oligo stocks",
      "description": "Using protocol details and Incident E observations, infer the most likely root cause(s) for an apparent ligation failure (no gel shift after ligation), dominant short artifacts in final libraries, adapter/primer-like enrichment at Read 1 starts, and low frequency of the expected linker prefix. Propose confirmation steps focused on oligo identity/modifications and read-structure validation, plus specific fixes and protocol procurement/specification changes to prevent recurrence.",
      "suggested_approach": "Adapter/ligation forensics: (1) From protocol.md, capture the exact ligation chemistry (T4 RNA ligase 1 vs 2 truncated, requirement for 5' phosphate on insert or adapter, requirement for pre-adenylated adapter, 3' blocking groups, RNA vs DNA adapter). (2) Map observations: no ligation shift + reproducible failure + new oligo paperwork differences strongly implicate wrong oligo type/modification/purification (e.g., missing 5' adenylation, wrong terminal phosphate/block, DNA vs RNA when enzyme requires RNA, reversed orientation/sequence). (3) Computational confirmation: scan raw reads for the expected constant adapter/linker prefix; quantify motif frequency; determine whether reads start with primer-dimer/adapter sequences consistent with self-ligation or PCR artifacts. (4) Wet-lab recommendations (future): run a ligation positive control with known substrates, verify oligo by mass/spec or vendor QC, re-order with explicit modifications and HPLC purification, implement incoming-oligo acceptance checklist. (5) Prevention: lock down part numbers/sequences, include an “expected read structure” schematic in protocol, and add a small sequencing-based smoke test for each new oligo lot.",
      "DB_flag": 1,
      "DB_list": "protocol.md"
    },
    {
      "id": "1_6_Preliminary_Data_Analysis",
      "title": "Pilot single-transcript Ribo-seq analysis: FASTQ to per-position counts + QC report",
      "description": "Process reads.fastq.gz against reference.fa (single transcript) using the protocol-specified adapter/UMI structure to generate: (i) counts_raw.csv and counts_dedup.csv containing footprint counts per transcript position (clearly define coordinate system, e.g., 1-based transcript positions for 5' read start or inferred P-site), (ii) a histogram plot of 5' start positions across the transcript for raw vs deduplicated, and (iii) a single HTML QC report summarizing read-length distribution, adapter/UMI structure validation, alignment summary, duplication/UMI complexity, periodicity/frame signal if ORF can be inferred, and an interpretation with 2–4 concrete follow-up checks/next steps.",
      "suggested_approach": "End-to-end minimal Ribo-seq pipeline (single transcript): (1) Read-structure handling: use protocol.md to define adapter sequences and UMI location; perform UMI extraction first (UMI-tools extract or fastp + custom parsing), then adapter trimming (cutadapt/fastp), then quality filtering. (2) Alignment: align to reference.fa using a short-read aligner (bowtie2 in end-to-end mode, or minimap2 -ax sr) and retain uniquely aligned reads; compute 5' start position on the transcript (strand-aware if applicable). (3) Counting: build per-position arrays for 5' start counts; produce counts_raw.csv (all aligned reads) and counts_dedup.csv (deduplicate by {UMI, start_position} or {UMI, start_position, length} as justified). (4) QC metrics: read-length distribution pre/post trim; fraction containing expected linker motifs; per-base quality in UMI window; UMI diversity/entropy; duplication rate before/after dedup; 3-nt periodicity by computing frame of 5' starts relative to inferred ORF (infer ORF by scanning reference for start/stop if no annotation is provided; document assumptions). (5) Reporting: generate an HTML report via Rmarkdown/Quarto or Jupyter+nbconvert including plots (start-position histogram raw vs dedup; UMI histogram; length distribution) and written interpretation + actionable next checks (e.g., validate UMI randomness, restrict to canonical footprint lengths, inspect offsets for periodicity).",
      "DB_flag": 1,
      "DB_list": "protocol.md,reference.fa,reads.fastq.gz"
    }
  ]
}