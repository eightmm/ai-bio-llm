# Problem
[예시 문제1] T 세포 유전자 간 기능 유사성 정량화
T 세포에서는 항원 인식, 활성화, 분화 등 다양한 기능을 수행하는 유전자들이 네트워크 형태로 작동한다. 일반적으로 기능적으로 유사한 유전자쌍은
        •        발현 패턴(expr_corr)이 비슷하거나,
        •        단백질 구조(struct_sim)가 유사하거나,
        •        진화적 계통(phylo_sim)이 가깝다는 특징을 가진다.
문제의 목표는 발현 데이터(features)와 유전자 이름(genelist.csv, ENSMUSG+gene name)을 통합하여 유전자간 유사성 점수(Function Similarity Score)를 구축하고 이를 기준으로 유전자군을 정의하는 것이다.


입력 데이터: Q1 features 파일 
* TPM expression 파일 포함
* genelist 포함
* CD4 T, CD8 T 세포 포함
* 휴지 T 세포: naive, memory T 세포
* 활성 T 세포: TH0, TH1, TH2, TH17, TREG, 0.5/1/2/4h 등




위에 입력된 데이터를 기반으로 아래 요구 사항을 충족하는 분석 전략을 제시하라.
(1) LLM 기반 유전자 기능 요약 생성
(2) LLM 기반 phylogenic tree (knowledge-based) 생성
(3) Expression 기반 유사성 점수 생성
(4) (1,2,3) 을 통합한 Similarity Score에 따라 휴지기 T 세포 (naive or memory T 세포)조절에 주요한 유전자쌍을 제시하고, 근거와 생물학적 기능(없을시 생략 가능)을 제시하라. 
(5) 휴지기 T 세포 내 상위 발현 300개 gene을 대상으로 공개된 단백질, 도메인 정보를 활용하여 단백질 구조 유사도 점수를 생성하고 휴지기 조절에 중요한 유전자 쌍을 예측하라.


---

# Prior research / evidence summary (Search output)
# Integrated Multi-Modal Strategy for Quantifying T Cell Gene Functional Similarity: A Comprehensive Framework Combining Expression, Knowledge-Based Phylogenetic, and Structural Approaches

This report presents a comprehensive analysis strategy designed to quantify functional similarity between genes that regulate T cell quiescence and differentiation by integrating expression-based metrics, large language model-derived functional and evolutionary knowledge, and protein structure similarities. The approach combines multi-omic data analysis with modern machine learning techniques to identify key gene regulatory pairs controlling naive and memory T cell states. By synthesizing transcriptomic patterns across multiple T cell conditions with knowledge-driven functional hierarchies and structural information, this framework enables the systematic identification of genes whose coordinated expression drives T cell homeostasis and immune tolerance.

## Multi-Modal Data Integration Framework for T Cell Gene Analysis

The foundation of this analytical strategy rests on recognizing that genes regulating T cell quiescence and differentiation operate through interconnected functional domains that cannot be fully captured by any single measurement modality. Recent advances in computational biology have demonstrated that integrating multiple data types—transcriptomic, structural, and knowledge-based—significantly improves the accuracy of functional inferences compared to single-modality approaches[1]. In the context of T cell biology, where genes coordinate complex processes of activation, differentiation, and memory formation through networks of signal transduction and chromatin remodeling, a multi-modal approach becomes particularly essential[39][42]. The proposed framework operationalizes this principle by establishing four distinct but interconnected analytical layers: expression-based similarity quantification, language model-derived functional characterization, knowledge-driven phylogenetic relationship inference, and structure-based functional prediction. Each layer contributes complementary information that, when integrated, provides a more complete picture of how genes collectively regulate T cell state transitions than would be possible from individual modalities alone.

### Theoretical Foundations of Multi-Modal Gene Similarity

The conceptual basis for multi-modal integration in gene analysis derives from the observation that functional relationships between genes manifest across multiple observable properties. Two genes may regulate the same T cell developmental process through entirely different molecular mechanisms—one through chromatin remodeling and the other through signal transduction—yet their integration in a unified similarity framework reveals their coordinated roles in controlling cell fate[39]. This principle has been validated across numerous biological systems, where computational methods that preserve modality-specific variation while identifying shared regulatory patterns outperform those relying on single data types[1]. In the specific context of T cell biology, evidence suggests that genes governing naive T cell maintenance operate through hierarchical regulatory networks where certain transcription factors occupy critical hub positions by virtue of their ability to coordinate both epigenetic and transcriptional responses[13]. By capturing functional similarity through multiple complementary measures, the proposed framework can identify not only obvious co-regulators sharing similar expression patterns but also functionally coordinated genes that diverge transcriptionally but converge on common cellular outcomes.

## Strategy Component 1: Large Language Model-Based Gene Functional Summary Generation

### Conceptual Framework for LLM Application in Gene Functional Characterization

The first analytical component leverages large language models to generate comprehensive functional summaries of genes involved in T cell regulation based on their names, known associations, and immunological context. This application of transformer-based models to genomics represents an emerging paradigm in bioinformatics, where language models trained on biological literature and sequence data can infer functional properties of genes by treating genetic sequences and gene names as a biological language amenable to semantic analysis[7][10]. The theoretical motivation for this approach rests on the observation that gene names and their associated biological functions are often semantically encoded in annotations, literature, and domain knowledge that language models can effectively extract and synthesize. Specifically, gene names frequently contain morphological hints about function (e.g., "Foxp3" indicates a forkhead box transcription factor; "Il2ra" indicates an interleukin receptor), while their context within immunological processes is documented across extensive scientific literature that language models can internalize[24].

### Implementation Strategy for Functional Summary Generation

The practical implementation of LLM-based functional summary generation begins with the input genelist that includes both ENSMUSG identifiers and common gene names for genes expressed in the provided T cell dataset spanning naive, memory, and activated states across CD4+ and CD8+ subsets. For each gene in the analysis set, a structured prompt is constructed that incorporates the gene name, known cellular context (T cell type, activation state), and relevant immunological processes. The LLM is then queried to generate a functional summary encompassing several key dimensions: primary molecular function (e.g., transcription factor, cytokine receptor, signaling adapter), cellular roles in T cell development (e.g., naive T cell maintenance, effector differentiation, memory formation), regulatory mechanisms (e.g., transcriptional regulation, chromatin remodeling, signal transduction), and known disease associations or therapeutic relevance. This multi-dimensional characterization serves several purposes within the broader analytical framework. First, it establishes a standardized functional vocabulary that enables comparison across genes with disparate molecular mechanisms. Second, it captures the contextual embeddedness of genes within T cell regulatory networks by explicitly incorporating knowledge of their roles in specific cellular processes. Third, it creates a foundation for subsequent phylogenetic inference by identifying functional families and evolutionary relationships that the language model can recognize from functional patterns. The generated summaries are then converted into numerical embeddings using the same language model's representation space, enabling vector-based similarity calculations that preserve semantic relationships between genes[7].

### Quality Control and Validation for LLM-Generated Summaries

An essential consideration in leveraging language model outputs is establishing validation mechanisms to ensure accuracy and contextual appropriateness. The functional summaries generated by the LLM should be spot-checked against curated immunology databases such as the Immune Epitope Database (IEDB) and validated against existing literature on key T cell regulatory genes such as Foxp3, Tcf7, Eomes, and Tbx21[13][16]. For a representative subset of approximately twenty percent of the analyzed genes spanning different functional categories (transcription factors, cytokine receptors, signaling adapters, epigenetic modifiers), the LLM-generated summaries are manually reviewed by an immunologist to assess accuracy and relevance. This validation step identifies any systematic biases in the model's output—for instance, potential overemphasis on canonical functions at the expense of newly described roles, or context-specific misattributions. Genes whose LLM summaries fail this validation step are flagged for manual summary generation or refined prompting strategies. Additionally, cross-validation against Gene Ontology annotations and pathway database assignments provides an orthogonal check on the functional characterization's biological appropriateness[2][31].

## Strategy Component 2: Knowledge-Driven Phylogenetic Tree Construction Using Language Models

### Theoretical Basis for LLM-Derived Evolutionary and Functional Hierarchies

The second analytical component constructs a knowledge-based phylogenetic framework that captures evolutionary and functional relationships between T cell regulatory genes. This approach differs fundamentally from traditional sequence-based phylogenetic reconstruction in that it leverages the LLM's ability to recognize functional and evolutionary relationships that are implicit in gene names, protein domains, and regulatory roles rather than explicit in DNA sequences. The theoretical justification for this alternative approach lies in recognizing that genes regulating T cell quiescence often belong to multi-gene families where evolutionary diversification has accompanied functional specialization—exemplified by the transcription factor families (e.g., T-box factors, forkhead factors) that govern T cell fate decisions[13]. Language models can recognize these family relationships by identifying common functional motifs, shared regulatory logic, and co-occurrence patterns in biological literature, enabling the construction of functional hierarchies that parallel evolutionary relationships[24]. Furthermore, for genes with complex regulatory roles spanning multiple functional categories, a knowledge-based tree may more accurately capture their position within T cell regulatory networks than traditional phylogenetic approaches focused solely on sequence homology[3].

### Implementation Framework for Knowledge-Based Tree Construction

The practical construction of a knowledge-driven phylogenetic tree proceeds through several iterative steps. First, genes in the analysis set are clustered into functional families based on their LLM-generated summaries and known domain compositions. This initial clustering leverages both the semantic embeddings derived from functional summaries and explicit domain annotations retrieved from databases such as Pfam and InterPro[15][18]. The LLM is then queried to identify hierarchical relationships within these functional families—for instance, recognizing that different T-box transcription factors (T-bet, Eomes, Runx family members) constitute a functional subfamily within the broader family of transcription factors governing T cell differentiation[13]. To construct this hierarchy explicitly, the LLM is prompted to position genes based on their evolutionary origin, functional specialization, and regulatory relationships. For transcription factor families, this might involve organizing genes based on their primary regulatory targets and the developmental stages at which they exert maximal influence—for example, recognizing that TCF-1 and LEF-1 maintain naive T cell identity through chromatin architecture control, while Blimp-1 and T-bet drive effector differentiation[16][42]. For signal transduction genes, the hierarchy reflects upstream-to-downstream relationships in signaling cascades, allowing the tree to capture how information flows from cell surface receptors through intracellular mediators to transcriptional effectors.

### Translating Knowledge-Based Hierarchies into Quantitative Similarity Metrics

To integrate the knowledge-based phylogenetic framework into a quantitative similarity metric, the tree structure is converted into a graph representation where nodes represent genes and edges encode phylogenetic or functional proximity. The tree depth at which two genes share a common ancestor (in functional rather than evolutionary terms) provides one component of a phylogenetic similarity score. Additionally, the LLM-derived functional characterizations are analyzed to extract specific regulatory relationships and mechanistic similarities that inform edge weights in the tree graph. For instance, if two transcription factors are recognized as co-activators of the same gene set in naive T cells, this mechanistic similarity increases their phylogenetic proximity in the constructed tree. The resulting tree can then be used to compute pairwise distances between genes using standard phylogenetic distance metrics such as the cophenetic distance, which measures the distance between terminal nodes (individual genes) based on the height of their most recent common ancestor in the tree[6]. These phylogenetic distances are converted into similarity scores by applying an inverse transformation where greater distance corresponds to lower similarity. This quantitative representation of knowledge-based phylogenetic relationships provides a bridge between symbolic tree representations and the numerical similarity metrics required for downstream integration[22].

## Strategy Component 3: Expression-Based Gene Similarity Score Generation

### Multi-Dimensional Expression Similarity Quantification

The third analytical component constructs comprehensive expression-based similarity scores by leveraging the multi-condition transcriptomic data spanning naive T cells, memory T cells, and multiple activated T cell populations (TH0, TH1, TH2, TH17, Treg) across temporal dimensions (0.5h, 1h, 2h, 4h post-activation). The fundamental premise underlying expression-based similarity is that genes with correlated expression patterns across biological conditions often participate in common regulatory modules and functional processes. However, the specific measure used to quantify this correlation is consequential and should reflect the multi-faceted nature of T cell gene regulation. Rather than relying solely on Pearson correlation across all samples, which treats all conditions equally and may miss condition-specific relationships, the proposed framework implements multiple complementary correlation measures and then integrates them based on their biological relevance to T cell quiescence regulation.

### Hierarchical Expression Similarity Metrics Across T Cell States

The first layer of expression-based similarity focuses on resting T cell states specifically, computing Spearman rank correlation coefficients between pairs of genes across all naive and memory T cell samples in the expression dataset[12][26]. The use of Spearman correlation rather than Pearson correlation is motivated by the heterogeneity inherent in single-cell expression data and bulk T cell populations, where outlier cells or samples with extremely high or low expression for particular genes might skew linear correlation estimates. The resulting correlation matrix captures which genes maintain coordinated expression in the quiescent state and identifies gene pairs whose transcriptional regulation is mechanistically linked through shared transcription factors or common upstream signaling. A second layer computes expression similarity specifically for genes that show divergent patterns between resting and activated states—the hypothesis being that genes whose expression ratios change concordantly upon T cell activation may constitute a functional module governing the resting-to-activated transition. This is computed as the correlation of fold-change vectors between rest and activation across all time points, identifying genes that are activated or repressed in concert during T cell stimulation. A third layer implements weighted correlation where different T cell subsets and conditions receive weights reflecting their relevance to resting T cell biology. For instance, comparisons between naive and memory T cells receive higher weights than comparisons with activated T cell populations, on the premise that the more similar two conditions are to the resting state, the more informative their coordinated gene expression is about resting T cell regulation.

### Information-Theoretic Measures for Capturing Condition-Specific Gene Co-Expression

Beyond correlation-based measures, the expression-based similarity framework incorporates information-theoretic approaches that capture statistical dependency relationships not necessarily reflected in linear correlations. Mutual information between genes is computed across the TPM expression matrix, measuring how much knowing the expression level of one gene reduces uncertainty about the expression level of another[24]. This approach is particularly valuable for identifying non-linear relationships and capturing the behavior of genes in the tails of expression distributions—for instance, recognizing that two genes are never simultaneously highly expressed, suggesting competitive or mutually exclusive regulatory logic. The mutual information scores are then processed through data processing inequality algorithms such as ARACNE to eliminate indirect associations and identify direct regulatory relationships[24]. The resulting pruned mutual information matrix provides a complementary view of gene co-expression relationships, identifying genes whose expression coordination reflects direct mechanistic linkage rather than sharing a common upstream regulator.

### Conditional Expression Similarity for Cell-Type-Specific Relationships

A critical refinement to expression-based similarity scoring acknowledges that naive T cell gene regulation differs between CD4+ and CD8+ subsets, and understanding these differences is essential for identifying genes specifically important for quiescence in each population. The framework therefore computes separate expression similarity matrices for CD4+ and CD8+ T cells, then identifies gene pairs with high similarity within each subset but potentially different patterns between subsets. This cell-type-specific analysis reveals which genes represent general principles of T cell quiescence applicable across lineages versus which genes show lineage-specific regulatory coordination. For instance, Foxp3 and Il2ra show strong coordinated expression in CD4+ Treg cells but may show different patterns in CD8+ T cell populations, reflecting their distinct roles in CD8+ homeostasis versus CD4+ Treg differentiation[13][54].

### Quantitative Integration of Multiple Expression Similarity Measures

To synthesize the various expression-based similarity measures into a unified score, the framework implements a weighted average where each measure receives a weight reflecting its biological relevance to resting T cell regulation. Spearman correlation between gene expression levels in resting T cells receives the highest weight, reflecting that this most directly captures the coordinated gene expression in the state of interest. Mutual information receives moderate weight, capturing non-linear dependencies. Fold-change correlation receives lower weight, since it reflects activation-associated gene coordination rather than resting state regulation. These weights can be optimized using machine learning approaches where genes known from literature to be important for resting T cell maintenance (such as TCF-1, LEF-1, IL-7R, IL-15R signaling components, and key epigenetic regulators) are used as positive examples to train a model that learns optimal weight combinations[24][43]. The resulting integrated expression similarity score for each gene pair ranges from -1 to 1, where 1 represents maximum coordinated expression in resting conditions and -1 represents reciprocal expression patterns.

## Strategy Component 4: Integrated Multi-Modal Similarity Scoring and Gene Pair Prioritization

### Composite Similarity Score Framework

The fourth analytical component integrates the three independent measures of gene similarity—LLM-derived functional summaries, knowledge-based phylogenetic distances, and expression-based correlations—into a unified composite similarity score that prioritizes gene pairs most likely to be important for resting T cell regulation. The integration methodology follows established multi-modal fusion principles where each modality contributes complementary information, and the integration weighting reflects both the quality of each modality's predictions and their biological relevance to the problem domain[1][19][22]. Rather than implementing a simple additive combination of normalized scores, which would assume equal importance across modalities, the framework employs a supervised learning approach where known gene regulatory relationships controlling T cell quiescence are used to optimize integration weights.

### Supervised Learning for Integration Weight Optimization

The optimization process begins by assembling a training dataset of gene pairs with established regulatory relationships in T cell quiescence. This training set is constructed by mining literature on known regulators of naive and memory T cell maintenance—for instance, recognizing that TCF-1 and CTCF cooperate to maintain naive T cell chromatin architecture, that IL-7 and IL-15 signaling through shared receptor components coordinates T cell homeostasis, and that TET2 and DNMT3A show opposing effects on T cell differentiation through DNA methylation[16][39][42]. For each pair of genes in the training set, the three similarity scores are computed independently. A machine learning model (such as logistic regression with cross-validation) is then trained to predict whether gene pairs are functionally related in resting T cell biology based on their combined similarity scores. The model learns optimal weights for each modality by maximizing prediction accuracy on held-out test sets. Critically, this approach acknowledges that different types of gene relationships may require different weighting schemes—for instance, transcriptional regulatory relationships (where genes are directly connected through binding events) may show stronger functional similarity while showing weaker expression correlation if the regulator is expressed at low levels. By allowing the model to learn these nuances, the integration methodology becomes more sophisticated than simple averaging approaches[43].

### Biological Filtering and Mechanistic Prioritization

Once the composite similarity scores are computed for all gene pairs, the framework applies biological filters to prioritize pairs most likely to be mechanistically important for resting T cell regulation. The primary filter restricts attention to genes that show substantial expression in the resting T cell populations examined—specifically, genes in the top quartile of expression in naive or memory T cells. This filter reflects the principle that genes expressed at very low levels in resting T cells are unlikely to play major regulatory roles in maintaining quiescence, regardless of how strongly they correlate with other genes. A second filter identifies gene pairs that show expression patterns consistent with known regulatory relationships—for instance, transcription factor-target gene pairs where the transcription factor shows higher expression in conditions where its target gene is transcribed. This mechanistic filter recognizes that some high-similarity gene pairs may represent co-regulation by common upstream factors rather than direct functional interaction. A third filter prioritizes gene pairs whose composite similarity score is driven by contributions from at least two modalities, reflecting confidence that the relationship represents genuine functional linkage rather than artifact of a single measurement modality[1].

### Systematic Identification of Gene Pairs Critical for Resting T Cell Regulation

With these filters applied, the framework identifies the top-ranked gene pairs in the composite similarity score distribution. For genes involved in naive T cell maintenance, the top-ranked pairs typically involve (1) transcription factors that cooperatively regulate naive T cell identity genes (such as TCF-1 with LEF-1 or Runx3 with Bcl11b), (2) signal transduction components that coordinate lymph node homing and homeostatic proliferation responses (such as S1P receptor with CCR7 in naive T cell trafficking), and (3) epigenetic regulators that maintain open chromatin at naive T cell-specific genes while keeping effector-associated genes silenced (such as TET2 with DNMT3A in maintaining DNA methylation patterns)[16][39]. For genes in memory T cells, the framework identifies pairs involved in (1) persistence mechanisms that sustain memory T cell longevity (such as IL-7 receptor components with anti-apoptotic factors), (2) rapid recall responses that enable accelerated reactivation upon antigen re-encounter (such as transcription factors governing immediate effector functions), and (3) lineage fidelity mechanisms that maintain memory T cell identity during long-term homeostasis[13][26][29].

### Supported Biological Rationale for Top Gene Pairs

The identified gene pairs are contextualized with biological rationale derived from multiple evidence sources. For each high-priority gene pair, the report documents: the specific types of similarity signals supporting the relationship (expression correlation, functional overlap, phylogenetic proximity), the known biological processes in which both genes participate, any direct evidence of genetic or biochemical interaction, and the cellular contexts in which this interaction appears most important based on condition-specific expression patterns. For example, the pair TCF-1 (Tcf7) and LEF-1 (Lef1) would be identified as critical for naive T cell maintenance based on multiple lines of evidence: high expression correlation in naive T cells across both CD4+ and CD8+ lineages, shared functional roles in maintaining DNA methylation-based epigenetic memory and 3D chromatin architecture, phylogenetic proximity as both being TCF/LEF family transcription factors, and extensive literature documenting their cooperative binding at enhancers controlling naive T cell identity genes[16][39][42]. The biological rationale would further note that this pair represents a core mechanism by which naive T cells maintain their quiescent phenotype in the absence of antigen stimulation, and that disruption of either member of the pair leads to inappropriate T cell activation or loss of naive T cell identity[28][39].

## Strategy Component 5: Protein Structure and Domain-Based Similarity Scoring

### Rationale for Integrating Structural Information into Gene Similarity Assessment

The fifth analytical component incorporates structural and domain-level information to augment the functional similarity assessment with molecular-level mechanistic details. Recent advances in protein structure prediction and the availability of comprehensive domain annotation databases have made this level of analysis increasingly tractable. The theoretical basis for incorporating structural similarity into gene functional assessment derives from the well-established principle that protein structure is more conserved across evolution than amino acid sequence, and that proteins with similar three-dimensional structures often converge on similar mechanisms for catalysis, binding, or cellular localization despite sequence divergence[8][37][40]. For T cell regulatory genes, structural information reveals shared molecular mechanisms among genes that may not appear functionally related at higher levels of biological organization—for instance, recognizing that structurally homologous domain architectures in different transcription factors enable them to bind similar DNA motifs despite minimal sequence similarity[21][38].

### Systematic Identification and Characterization of Top 300 Resting T Cell Expressed Genes

The practical implementation of structural similarity scoring begins by identifying the genes showing highest average expression in naive and memory T cell populations, ranking genes by their mean TPM values across all resting state samples and selecting the top three hundred genes for detailed structural analysis. This focused set is selected because genes highly expressed in resting T cells are more likely to play important roles in maintaining quiescence and distinguishing resting from activated states. For each of these three hundred genes, the analysis retrieves protein sequences from UniProt and domain annotations from Pfam and InterPro databases[15][18][48]. The combination of sequence and domain information provides the foundation for computing structure-based similarities between genes.

### Structure Prediction Using AlphaFold Models

For genes in the top three hundred resting T cell-expressed set, predicted three-dimensional protein structures are retrieved from the AlphaFold Protein Structure Database[11][52]. The AlphaFold models provide predicted atomic-level coordinates for the vast majority of proteins encoded by the mammalian genome with high accuracy and uniform quality, enabling systematic structure-based comparisons without the bias of working only with experimentally determined structures from the Protein Data Bank[49]. The AlphaFold structures serve as the foundation for computing pairwise structure similarities using template modeling (TM) scores, which measure global structural similarity in a manner independent of protein length[37][40]. The TM-score metric is selected over alternative measures such as RMSD because it naturally weights global structural similarity more strongly than local structural deviations and provides a length-independent measure suitable for comparing proteins of widely varying sizes[37]. Protein pairs with TM-scores exceeding 0.5 are generally considered to share similar folds with strong functional and evolutionary relationships, while those below 0.5 typically represent structurally divergent proteins[37][40].

### Reciprocal Best Structure Hits for Discovering Functionally Related Gene Pairs

Beyond simple pairwise TM-score comparisons, the structural analysis implements a reciprocal best structure hits (RBSH) approach analogous to reciprocal best BLAST hits used in sequence-based homology inference[8]. In this approach, for each query gene, the algorithm identifies the gene in the top three hundred set whose structure most closely matches the query (highest TM-score). Then, for that best-match gene, the algorithm determines whether the original query gene is reciprocally the best structural match. Pairs meeting this reciprocal best match criterion represent structurally conserved relationships and suggest functional and evolutionary conservation despite sequence divergence. This approach has proven effective for identifying previously unrecognized homologous relationships between proteins from divergent organisms where sequence similarity has degraded but structural conservation persists[8]. Applied to T cell genes, RBSH identifies gene pairs that maintain conserved molecular mechanisms and domain organizations despite potentially significant sequence divergence, suggesting their functional roles may be more similar than raw sequence comparison would indicate.

### Domain Architecture Analysis and Functional Similarity Inference

Complementing the structure-based approach, the analysis systematically compares domain architectures across genes in the top three hundred set. The domain architecture—the linear arrangement of functional domains within a protein sequence—provides a coarse-grained description of protein function and mechanism that often correlates with functional similarity even when fine-grained sequence details diverge[50]. For each gene pair in the top three hundred set, the analysis compares their domain compositions using several metrics. First, the Jaccard similarity coefficient is computed, measuring the proportion of domains shared between two proteins relative to their total domain content. Second, the conservation of domain order is assessed, as proteins with the same domains in different orders typically have different functions. Third, the analysis identifies specific domain types shared between gene pairs and cross-references these against known functional roles of each domain type. For instance, recognizing that two genes share a kinase domain, a PDZ-binding domain, and a membrane targeting signal suggests they may participate in similar signaling mechanisms at the cell membrane. Gene pairs sharing multiple domains with preserved domain order receive high structural similarity scores, reflecting the likelihood that they employ similar molecular mechanisms.

### Integrating Structural and Domain Similarity with Expression and Functional Information

The structural and domain-based similarity measures are integrated with previously computed expression-based and functional similarities using the multi-modal integration framework described in Strategy Component 4. Critically, structural similarity is weighted somewhat lower than expression and functional similarities in the overall composite score for identifying T cell quiescence-relevant gene pairs, reflecting the principle that structural conservation does not always indicate functional equivalence in the context of a specific biological process like naive T cell maintenance. However, structural similarity serves an important confirmatory role—gene pairs that show high similarity on structural grounds and also on functional and expression grounds represent particularly strong candidates for mechanistic investigation. The framework therefore flags gene pairs that rank highly on multiple independent similarity metrics as the most likely candidates for experimental validation and further study.

### Validation Through Structural Alignment and Functional Domain Annotation

To ensure the quality of structural similarity assessments, the top-ranked gene pairs based on structural measures undergo detailed manual review. For each pair, a structural alignment is computed using alignment tools specialized for three-dimensional structures rather than sequences[8], and the quality of the alignment is visually inspected to confirm that the structural similarity is genuine rather than an artifact of model geometry. Additionally, any domains identified as conserved between gene pairs are examined against functional annotations in domain databases to ensure that shared domains correspond to shared functional capabilities. For instance, if two genes share a kinase domain but one gene's kinase domain is functionally inactivated by sequence divergence in the catalytic site, this would be noted as a limitation on the functional significance of the domain conservation.

## Implementation Roadmap and Computational Infrastructure

### Workflow Architecture and Modular Pipeline Design

The complete analytical strategy comprises multiple independent analyses that must be coordinated and integrated while maintaining computational efficiency and result reproducibility. The proposed implementation follows a modular pipeline architecture where distinct computational steps are separated into independent workflow stages, each with defined inputs and outputs, enabling parallel execution and facilitating troubleshooting and modification of individual components[27][30]. The pipeline architecture specifically follows the scientific workflow system paradigm, implementing the analysis using tools such as Nextflow or Snakemake that provide robust handling of computational job scheduling, resource allocation, error management, and result tracking[30][57][60]. This architecture choice is motivated by the need to handle multiple computational modalities (language model inference, correlation calculations on high-dimensional matrices, structure alignment, graph-based network analysis) that may be optimized for different computational platforms (GPU-accelerated LLM inference, multi-core matrix operations, specialized structural biology tools).

### Computational Requirements and Platform Considerations

The multi-stage implementation requires access to diverse computational resources. Language model inference for functional summary generation and phylogenetic tree construction requires GPU-accelerated computing, as state-of-the-art language models with sufficient scale to perform sophisticated biological reasoning typically contain billions of parameters and benefit substantially from GPU acceleration[7]. The expression-based similarity calculations operate on TPM matrices with dimensions on the order of (number of genes) × (number of conditions), typically several thousand by hundreds, making these calculations amenable to efficient execution on multi-core CPUs with matrix algebra optimization libraries. The protein structure analysis requires access to the AlphaFold Protein Structure Database and specialized structural alignment tools, which may be most efficiently accessed through cloud or high-performance computing platforms. The supervised learning step for integration weight optimization requires implementation of standard machine learning libraries supporting cross-validation and hyperparameter optimization. The modular workflow architecture enables allocation of different pipeline stages to the most appropriate computational platforms, optimizing cost and runtime efficiency[30][57].

### Quality Control and Benchmarking Throughout the Pipeline

At each stage of the multi-stage pipeline, quality control checkpoints are implemented to identify and flag problematic results before propagation to downstream analyses[43][46]. For LLM-based analyses, spot-checking of generated functional summaries against literature and curated databases occurs as described in Strategy Component 1. For expression-based analyses, quality control includes verification that correlation matrices possess expected statistical properties (e.g., correlation with self equals 1, correlations between random gene pairs follow expected null distributions), and assessment of whether identified high-correlation gene pairs are consistent with known T cell regulatory relationships. For structural analyses, quality control includes validation that TM-score calculations produce expected results on known homologous pairs, visual inspection of structural alignments for top-ranked gene pairs, and comparison of identified structural relationships to existing curated databases of protein relationships. The machine learning model trained for integration weight optimization undergoes extensive cross-validation to assess generalization performance and identify cases where the model may be overfitting to the training set[43].

### Result Output and Knowledge Base Construction

The multi-stage pipeline produces diverse outputs that require systematic organization and accessibility for subsequent analysis and biological interpretation. The proposed framework implements a knowledge base structure where results are organized hierarchically: at the highest level, integrated similarity scores and top-ranked gene pairs; at intermediate levels, the individual component scores (functional, phylogenetic, expression, structural) contributing to each integrated score; and at detailed levels, supporting evidence and mechanistic reasoning for each identified gene pair. This knowledge base structure enables researchers to interrogate results at different levels of resolution, from rapid assessment of which genes are predicted to regulate resting T cell maintenance to deep mechanistic exploration of why particular gene pairs appear functionally related. The knowledge base is implemented using standard graph database technologies that efficiently represent the network structure of gene-gene relationships and enable complex queries exploring multi-hop relationships through the gene interaction network.

## Integration of T Cell-Specific Biological Knowledge

### Incorporation of Condition-Specific Regulatory Logic

Throughout the multi-stage analytical strategy, specific biological knowledge about T cell development, activation, and differentiation is leveraged to ensure that the computational methods align with known cellular biology. The framework explicitly acknowledges that genes governing naive T cell maintenance operate through mechanisms distinct from those controlling memory T cell persistence or effector T cell differentiation. For naive T cell maintenance, the strategy prioritizes genes involved in quiescence-promoting mechanisms: transcription factors maintaining naive chromatin architecture (TCF-1, LEF-1), cytokine receptors supporting homeostatic proliferation (IL-7R, IL-15R), and epigenetic regulators preventing inappropriate effector gene expression[16][39]. For memory T cell regulation, the strategy recognizes that memory T cells balance between maintenance of stemness (enabling recall responses upon antigen re-encounter) and prevention of exhaustion, thus prioritizing genes involved in memory T cell self-renewal and prevention of terminal differentiation[29][39]. This biological stratification ensures that identified gene pairs are not simply those showing highest overall similarity across all conditions but rather those whose relationships are most specifically relevant to resting T cell biology.

### Context-Dependent Similarity Assessment

The multi-stage framework implements context-dependent assessment of gene similarity, where the relative weights of different similarity modalities adjust based on the specific biological question being addressed. For identifying genes that maintain naive T cell identity, expression-based similarity in naive T cell populations receives higher weighting than similarity in activated conditions, while phylogenetic proximity to known naive T cell-specific transcription factors receives elevated importance. For identifying genes important for memory T cell maintenance, expression patterns specific to memory T cells receive elevated weighting, and structural similarity to genes known to regulate long-term immune tolerance receives increased importance. This context-dependent weighting ensures that gene pairs identified as important for one resting T cell state may differ from those identified for another, capturing the known heterogeneity in regulatory mechanisms between naive and memory T cells.

## Anticipated Results and Biological Insights

### Expected Gene Pairs Critical for Naive T Cell Maintenance

Application of this comprehensive framework to the provided dataset is expected to identify several categories of gene pairs critical for maintaining naive T cell quiescence. The most prominent category will likely include transcription factor pairs governing naive chromatin architecture, with TCF-1/LEF-1, TCF-1/Runx3, and Runx3/Bcl11b among the highest-ranked pairs. These pairs are predicted to rank highly because: (1) all three genes show high expression in naive T cells across both CD4+ and CD8+ compartments, (2) their functional summaries generated by LLM analysis will highlight their roles in chromatin organization and epigenetic memory, (3) phylogenetic relationships will place them together in the transcription factor family hierarchy, (4) their expression shows correlation across naive and memory states but not in activated conditions, and (5) structural analysis will reveal shared DNA-binding domain architectures enabling recognition of similar genomic targets. A second prominent category will include signal transduction components supporting homeostatic proliferation: IL-7R alpha chain with IL-7R beta chain (the receptor subunits sharing signaling), IL-7R with STAT5 signaling mediators, and IL-7R with anti-apoptotic factors like Bcl2. These pairs are predicted to rank highly based on their coordinated role in IL-7-dependent survival signaling necessary for naive T cell maintenance in peripheral lymphoid organs[26][54].

### Expected Gene Pairs Important for Memory T Cell Persistence

For memory T cells, the framework is expected to identify gene pairs reflecting both the persistence mechanisms that sustain memory T cell longevity and the rapid recall mechanisms enabling accelerated responses. A key predicted category involves transcription factor pairs governing memory T cell lineage commitment and maintenance—likely including pairs involving Foxp1, CCR7-associated transcription factors, and LEF-1 (which maintains stemness for TCM cells). These pairs would show high similarity driven by expression coordination specifically in memory T cells, functional overlap in maintaining memory T cell phenotype, and phylogenetic proximity among memory-associated transcription factor families. A second predicted category involves genes regulating rapid effector function upon antigen re-encounter: pairs of immediate early genes (c-fos, c-jun), pairs of effector molecules (cytokine genes, cytotoxic molecules), and pairs of signal transduction components that enable rapid TCR-mediated proliferation and differentiation. These pairs are expected to be identified through their correlated upregulation during T cell activation specifically in memory T cells compared to naive T cells, and their functional coordination in rapid recall responses.

### Novel Predictions and Hypothesis-Generating Insights

Beyond confirming known relationships, the comprehensive multi-modal framework is expected to generate novel predictions of gene pairs not previously recognized as functionally related in T cell biology. Such predictions are most likely to emerge from structural similarity analysis revealing mechanistically related genes with divergent sequences and from LLM-derived functional analysis recognizing implicit functional relationships in gene names or roles not captured by traditional annotation. For instance, the analysis might identify a previously underappreciated relationship between a little-studied transcription factor and a known naive T cell maintenance factor based on structural domain homology and complementary expression patterns, suggesting functional collaboration. Similarly, integrating phylogenetic information might identify that a gene product of unknown function shares evolutionary origin with established quiescence regulators, suggesting its role in related processes. These novel predictions would prioritize targets for experimental validation and provide entry points for understanding T cell regulatory mechanisms beyond the current annotated pathways.

## Validation Strategies and Experimental Follow-Up

### Computational Validation Through Cross-Modality Consistency

Before biological validation, the predicted gene pairs should be subjected to rigorous computational cross-validation ensuring that predictions are robust to methodological variations and not driven by systematic biases. One validation approach involves recomputing similarity scores using alternative methods for each modality (e.g., computing expression-based similarity using different distance metrics, employing alternative LLM models for functional summarization, implementing alternative phylogenetic inference approaches) and assessing whether top-ranked gene pairs remain consistently highly ranked across these methodological variations[43]. Gene pairs showing robust ranking across independent methodological implementations represent more confident predictions than those dependent on specific analytical choices.

### Biological Validation Through Literature Mining and Database Interrogation

A second validation layer involves systematic interrogation of scientific literature and functional genomics databases to assess whether predicted gene pairs have been identified as interacting in prior studies. For top-ranked gene pairs, the framework queries gene interaction databases (such as BioGRID) and performs targeted literature searches for any prior evidence of genetic or biochemical interaction, co-regulation, or functional cooperation. Importantly, this validation is conducted in a blinded fashion where computational predictions are compared to literature before examining the literature for any reference to the computational approach, avoiding circularity. Gene pairs with strong prior evidence of interaction provide positive controls validating the prediction framework, while gene pairs lacking prior evidence but showing strong predicted relationships represent hypothesis-generating candidates for experimental exploration.

### Experimental Validation Through Functional Studies

Finally, top-predicted gene pairs warrant experimental validation in T cell systems to confirm their functional cooperation in maintaining naive or memory T cell states. Standard experimental approaches include (1) CRISPR-mediated simultaneous deletion of both genes in a gene pair from naive T cells to assess whether combined deletion has synergistic effects on T cell activation or differentiation beyond additive effects of single deletions, (2) co-immunoprecipitation or proximity labeling experiments to directly assess physical interaction of gene products, (3) chromatin immunoprecipitation to determine whether predicted transcription factor pairs cooperatively occupy enhancers and promoters, and (4) single-cell transcriptomics of T cells with genetic perturbations to assess how simultaneous disruption of predicted gene pair members alters transcriptional programs. These experimental approaches would provide definitive validation of computational predictions and mechanistic understanding of how gene pairs regulate T cell quiescence.

## Conclusion and Broader Implications

This comprehensive multi-modal analytical framework for quantifying T cell gene functional similarity represents an integration of classical and emerging computational approaches to address a biologically significant problem. By combining expression-based similarity assessment with language model-derived functional knowledge, knowledge-driven phylogenetic relationship inference, and protein structure-based mechanistic analysis, the framework achieves a more sophisticated understanding of how genes regulate T cell quiescence than would be possible from any single analytical modality alone. The systematic identification of gene pairs most likely to be functionally important for naive and memory T cell maintenance provides both hypothesis-generating insights into T cell regulatory mechanisms and a prioritized list of targets for experimental investigation. Beyond the specific application to T cell biology, this framework demonstrates principles broadly applicable to other complex biological systems where genes coordinate multifaceted cellular processes through networks of physical interactions, transcriptional regulation, and metabolic cooperation. The modular workflow architecture ensures that components of the framework can be refined or replaced as new methods emerge, supporting iterative improvement and adaptation as biological knowledge evolves. Future implementations of this framework might incorporate single-cell multimodal data capturing simultaneous measurement of transcriptome, protein expression, and chromatin accessibility within individual T cells, enabling even more sophisticated inference of gene regulatory relationships. As large language models continue to advance in biological reasoning capability and protein structure prediction becomes even more accurate and comprehensive, the integration of these emerging methods into functional genomics frameworks will likely become increasingly central to understanding gene regulatory networks across diverse biological systems.

---

## References and Source Material

[1] Multi-modal generative modeling for joint analysis of single-cell T cell responses demonstrates superior performance of integrated TCR and transcriptome analysis compared to unimodal approaches, with average F1-scores of 0.821 versus 0.767 and 0.759 for individual modalities[1]

[2] Gene functional similarity calculation methods incorporating specificity of terms and edges in Gene Ontology provide more accurate measurements than traditional pairwise approaches[2]

[3] Phylogenetic inference based on histone modification data enables construction of cell-type trees reflecting differentiation relationships and providing insights into epigenetic changes during T cell development[3]

[4] Comparative analysis demonstrating that protein expression patterns measured through CITE-seq provide stronger discriminatory power for identifying T cell subsets than mRNA expression patterns alone, with tight clustering of CD4+ and CD8+ subsets based on protein markers[4]

[5] Gene Ontology semantic similarity tools and functional annotation approaches support systematic comparison and classification of proteins based on biological knowledge[5]

[6] Phylogenetic analysis frameworks for antibody repertoire evolution provide methods applicable to B cell clonal relationships and evolutionary dynamics[6]

[7] Gene-LLMs represent transformer-based genomic models using self-supervised pretraining on nucleotide sequences and gene expression data to decipher regulatory patterns and support diverse downstream applications[7]

[8] AlphaFold structure prediction enables discovery of homologous protein pairs through reciprocal best structure hits, identifying relationships missed by sequence-based approaches[8]

[9] Relationship between mRNA and protein expression in CD8+ T cells demonstrates gene class-specific mRNA-protein correlation patterns dependent on gene function and sequence characteristics[9]

[10] Large language models applied to gene-set analysis leverage powerful reasoning capability and rich modeling of biological context[10]

[13] Regulatory network analysis identifying key transcription factors controlling memory CD8+ T cell development through integration of ChIP and perturbation data[13]

[14] T cell development and differentiation controlled by signal transduction pathways initiated by TCR engagement and IL-7 signaling[14]

[16] Active maintenance of CD8+ T cell naivety through chromatin architecture control by Bach2 and Satb1 transcription factors[16]

[19] Comparative analysis of integrative classification methods for multi-omics data demonstrating advantages of integration approaches over single-modality analysis[19]

[21] Gene regulatory network prediction using machine learning and deep learning approaches achieving >95% accuracy when combining convolutional neural networks with traditional machine learning[21]

[22] Network-based integrative approaches for multi-omics analysis revolutionizing data integration through graph representations[22]

[24] Machine learning methods for gene regulatory network inference categorizing supervised, unsupervised, semi-supervised, and contrastive learning approaches[24]

[26] IL-7 receptor expression in early-differentiation stage T cells and importance of IL-7 signaling for T cell homeostasis[26]

[27] Bioinformatics pipeline frameworks providing workflow management infrastructure for reproducible computational analysis[27]

[28] VISTA checkpoint regulator restricting early T cell activation and maintaining naive T cell quiescence through control of epigenetic priming[28]

[29] Distinct subsets of stem-like CD8+ memory T cell progenitors with differential proliferative and exhaustion characteristics[29]

[30] Scientific workflow systems supporting bioinformatics pipeline development, deployment, and execution across diverse computational platforms[30]

[31] Gene Ontology semantic similarity tools enabling systematic comparison of proteins and identification of biological processes[31]

[39] Epigenetic priming as driver of memory recall and dysfunction showing how epigenetic mechanisms guide T cell activation and differentiation[39]

[42] Epigenetic regulation of T cell adaptive immunity through chromatin accessibility controlled by histone modifications and transcription factor interactions[42]

[43] Cross-validation for assessing accuracy of gene network prediction methods emphasizing importance of training/test set distinctness[43]

[46] Feature selection methods for machine learning addressing curse of dimensionality in genome-scale analysis[46]

[48] UniProt ID mapping services enabling conversion between different gene and protein identifier systems[48]

[50] Functional insights into immunoglobulin superfamily proteins showing structural diversity underlying functional versatility[50]

[52] AlphaFold Protein Structure Database providing bulk access to predicted structures for research organisms[52]

[54] IL-2 receptor role in regulatory T cell function demonstrating importance of IL-2 signaling for Treg differentiation and maintenance[54]

[57] Workflow manager comparison and selection strategies for bioinformatics pipeline implementation[57]

---

# Data analysis summary (Data analysis output)
### 1. Data Overview

The provided dataset consists of four CSV files capturing gene-level expression and annotation information across multiple T cell types and activation states in mouse (Ensembl IDs with ENSMUSG prefix).  

The first file, Q1.genelist.csv, contains 36,727 rows and two columns: Ensembl gene IDs and corresponding gene names. This serves as the master annotation table and reference index for all downstream integration. It is well-suited as the central gene identifier resource for the entire analysis.

The second file, Q1.features(nCD4).csv, contains 42,644 rows and 13 columns. It includes TPM expression values for naive CD4 T cells and a detailed activation time course (0.5h to 72h), along with precomputed mean resting and mean activated TPM values. This file provides high-resolution temporal expression dynamics for CD4 T cell activation and is directly usable for expression-based similarity calculations and resting-versus-activated contrasts.

The third file, Q1.features(nCD8).csv, includes 36,727 rows and 8 columns. It contains TPM expression values for naive CD8 T cells and selected activation time points (4h, 12h, 24h), as well as mean resting and mean activated TPM values. While the temporal resolution is lower than CD4, it is sufficient to compare resting versus activated expression patterns in CD8 T cells.

The fourth file, Q1.features(CD4 subtypes).csv, contains 26,260 rows and 12 columns. It provides expression values across multiple CD4 T helper subsets (Th0, Th1, Th2, Th9, Th17, Treg), along with naive and memory states. It also includes derived metrics such as resting mean TPM, activated mean TPM, and resting versus activated log2 fold change. This file is particularly valuable for identifying genes associated with resting (naive/memory) versus differentiated or activated CD4 states.

Collectively, these datasets are highly usable for constructing gene–gene similarity measures based on expression patterns across resting and activated T cell states, and for prioritizing genes relevant to naive and memory T cell regulation.

---

### 2. Column Dictionary (Detailed)

**File: Q1.genelist.csv**  
The “ensembl” column is a string representing the Ensembl gene identifier (ENSMUSG format), serving as the primary unique gene key. It should be used for all joins across files.  
The “gene_name” column is a string containing the common gene symbol. Biologically, it provides interpretability and linkage to known immunological functions. It should be used for reporting, annotation, and LLM-based functional summaries, but not as a join key due to potential duplication or ambiguity.

**File: Q1.features(nCD4).csv**  
The “ensembl” column is a string Ensembl gene ID and should be used as the join key.  
The “gene_name” column is a string gene symbol used for interpretation.  
The “naive” column is numeric TPM expression in naive CD4 T cells, representing resting state baseline expression.  
The “0.5h”, “1h”, “2h”, “4h”, “6h”, “12h”, “24h”, “48h”, and “72h” columns are numeric TPM values capturing a CD4 T cell activation time course following stimulation, reflecting early, intermediate, and late activation programs.  
The “mean_resting_TPM” column is numeric and summarizes expression across resting conditions (primarily naive). It should be used to rank genes by resting expression.  
The “mean_activated_TPM” column is numeric and summarizes expression across activated time points. It is useful for computing resting-versus-activated contrasts and similarity patterns.

**File: Q1.features(nCD8).csv**  
The “ensembl” column is a string Ensembl gene ID for joining.  
The “gene_name” column is a string gene symbol.  
The “naive” column is numeric TPM expression in naive CD8 T cells, representing resting expression.  
The “4h”, “12h”, and “24h” columns are numeric TPM values reflecting CD8 T cell activation at selected time points.  
The “mean_resting_tpm” column is numeric and summarizes resting expression.  
The “mean_activated_tpm” column is numeric and summarizes activated expression. These columns are recommended for resting-versus-activated comparisons in CD8 T cells.

**File: Q1.features(CD4 subtypes).csv**  
The “ensembl” column is a string Ensembl gene ID and join key.  
The “gene_name” column is a string gene symbol.  
The “naive” column is numeric TPM expression in naive CD4 T cells.  
The “Th0”, “Th1”, “Th17”, “Th2”, “Th9”, and “Treg” columns are numeric TPM values for differentiated CD4 T helper subsets, representing distinct functional states.  
The “memory” column is numeric TPM expression in memory CD4 T cells, a key resting-like state.  
The “meanTPM” column is numeric and represents overall mean expression across conditions.  
The “resting_mean_TPM” column is numeric and summarizes naive and memory expression, ideal for identifying resting T cell genes.  
The “activated_mean_TPM” column is numeric and summarizes activated/helper subset expression.  
The “resting_vs_activated_log2FC” column is numeric and quantifies differential expression between resting and activated states, directly useful for prioritizing resting T cell regulators.

---

### 3. Data Integrity & Quality

Ensembl gene IDs appear consistently across all files and are suitable as unique identifiers, although row counts differ between files, indicating that not all genes are present in every dataset. Gene names may not be unique and should not be used as primary keys. There is no explicit indication of missing values in the summaries, but expression matrices of this size typically include zero or near-zero TPM values for lowly expressed genes, which should be interpreted cautiously. Differences in column naming conventions, such as “mean_resting_TPM” versus “mean_resting_tpm”, require normalization during integration. Overall, the data quality is sufficient for large-scale similarity analysis, with standard preprocessing needed.

---

### 4. Sub-Problem Analysis: Data Applicability

**Sub-problem 1: Integrated Strategy for T Cell Gene Functional Similarity Scoring**  
This sub-problem requires integration of expression similarity, LLM-derived functional summaries, phylogenetic knowledge, and protein structure similarity. The expression-based component is fully supported by Q1.features(nCD4).csv, Q1.features(nCD8).csv, and Q1.features(CD4 subtypes).csv using TPM values, resting versus activated means, and log2 fold changes. The genelist file provides the necessary gene identifiers and names for LLM-based functional summarization and knowledge-based phylogenetic grouping. While no direct phylogenetic or protein structure data are included, the gene identifiers enable external annotation using public databases, making the data sufficient as an input backbone. Filtering strategies should include focusing on genes with high resting_mean_TPM and significant resting_vs_activated_log2FC to prioritize resting T cell regulators before computing similarity scores.

---

### 5. Biological Context (from Data)

The datasets cover mouse CD4 and CD8 T cells across naive, memory, and multiple activated or differentiated states. Resting T cells are represented by naive and memory conditions, while activation is captured through time-course stimulation (0.5h to 72h) and differentiation into Th1, Th2, Th17, Th9, and Treg subsets. Early activation time points reflect immediate-early signaling and transcriptional responses, whereas later time points and helper subsets represent stable effector programs. This biological breadth allows comparison of quiescent versus active transcriptional programs central to T cell homeostasis.

---

### 6. Recommendations for Solver

The optimal join key across all files is the “ensembl” gene ID. Gene names should be used only for interpretation and reporting. A major pitfall is inconsistent column naming across files, which must be harmonized before analysis. Another risk is overinterpreting low TPM values; filtering for sufficiently expressed genes in resting states is critical. The most critical analysis step is robust expression-based similarity calculation focused on resting conditions, as this anchors the identification of naive and memory T cell regulatory gene pairs.

---

### 7. Domain Knowledge Injection

Genes such as CCR7, IL7R, LTB, MALAT1, and TCF7 are classical markers of naive and memory T cells and are likely present among highly expressed resting genes. Early activation markers like CD69 and immediate-early transcription factors are expected to peak at 0.5–4h, while cytokines and effector molecules increase later. TPM values represent normalized transcript abundance; values above 1–5 TPM in resting cells generally indicate biologically meaningful expression. Log2 fold changes can be used to distinguish quiescence-associated genes from activation-induced genes.

---

### 8. Data Integration Strategy (Natural Language)

Integration should begin with Q1.genelist.csv as the central reference table. Each feature file should be left-joined to the genelist using the Ensembl gene ID to preserve annotation consistency. Column name harmonization should be applied to resting and activated mean TPM fields. Genes missing from certain datasets should be retained with partial data rather than excluded, as absence may reflect cell-type specificity. After integration, the expected row count will approximate the union of genes across all files, likely around 40,000 genes with varying completeness.

---

### 9. Step-by-Step Analysis Workflow (Natural Language)

First, load all four datasets and standardize column names, ensuring Ensembl IDs are consistent. Second, merge feature files with the genelist to create a unified gene-centric table. Third, identify resting T cell–relevant genes by filtering for high resting_mean_TPM and positive resting_vs_activated_log2FC in CD4 and CD8 contexts. Fourth, compute expression-based similarity between genes using correlation or distance metrics across resting and activation conditions. Fifth, generate LLM-based functional summaries for prioritized genes using gene names and known immunological roles, and organize them into functional or phylogenetic families. Sixth, incorporate external protein domain and structure annotations for the top 300 resting-expressed genes to estimate structural similarity. Finally, integrate expression similarity, functional/phylogenetic similarity, and structural similarity into a composite Functional Similarity Score, perform quality checks for biological plausibility, and output ranked gene pairs predicted to regulate naive and memory T cell states.

---

# Writing Task
Using all information above, write the final answer that **exactly matches the output format and requirements requested in the Problem**.

Mandatory rules:
- If the problem lists numbered requirements (e.g., "(1)...(5)"), **preserve the numbering/structure** in your answer.
- If the problem asks for a strategy/pipeline/analysis plan, include **concrete steps, inputs, outputs, metrics, and caveats**.
- If data files are mentioned, describe **what to read and what to compute** (procedure/algorithm-level; not necessarily code).
- Explicitly state **assumptions/limitations** where uncertainty or missing information exists.
- **Write in English.**

**Output only the final answer text.**
